import{j as e}from"./tanstack-BHj98Y4o.js";import{r}from"./vendor-BUcjPAt-.js";import{c as S,u as L,a as E,L as A,C as F,g as N,i as p,I,b as v,M as y,F as w}from"./index-pGaQqd3_.js";import{F as R}from"./funnel-BZnTtdAI.js";import{E as G}from"./external-link-BC31L8iP.js";import"./recharts-DyzHFDWD.js";const B=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],b=S("message-square",B),C={full_council:"Full Council",executive:"Executive",scrutiny:"Scrutiny",planning:"Planning",licensing:"Licensing",notice:"Forward Plan",partnership:"Partnership"},m={full_council:"#ff453a",executive:"#0a84ff",scrutiny:"#ff9f0a",planning:"#30d158",licensing:"#bf5af2",notice:"#8e8e93",partnership:"#64d2ff"};function H(l){return new Date(l+"T00:00:00").toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}function U(l){if(!l)return"TBC";const[i,n]=l.split(":"),t=parseInt(i,10);return`${t>12?t-12:t}:${n} ${t>=12?"PM":"AM"}`}function q(l){const i=new Date;i.setHours(0,0,0,0);const n=new Date(l+"T00:00:00"),t=Math.ceil((n-i)/(1e3*60*60*24));return t===0?"Today":t===1?"Tomorrow":t<0?"Past":`In ${t} days`}function K(){const l=L(),i=l.council_name||"Council",{data:n,loading:t,error:_}=E("/data/meetings.json"),[d,g]=r.useState("all"),[x,k]=r.useState(!1),[T,M]=r.useState(null);r.useEffect(()=>(document.title=`Meetings Calendar | ${i} Council Transparency`,()=>{document.title=`${i} Council Transparency | Where Your Money Goes`}),[i]);const u=r.useMemo(()=>{if(!n?.meetings)return[];const s=new Date;return s.setHours(0,0,0,0),n.meetings.filter(a=>!(!x&&new Date(a.date+"T00:00:00")<s&&!a.cancelled||a.cancelled&&!x||d!=="all"&&a.type!==d)).sort((a,o)=>a.date.localeCompare(o.date))},[n,d,x]),P=r.useMemo(()=>{if(!n?.meetings)return[];const s=new Set(n.meetings.map(a=>a.type));return Array.from(s)},[n]),$=r.useMemo(()=>n?.meetings?n.meetings.filter(s=>s.doge_relevance&&!s.cancelled).length:0,[n]);if(t)return e.jsx(A,{message:"Loading meetings calendar..."});if(_||!n)return e.jsxs("div",{className:"meetings-page animate-fade-in",children:[e.jsx("h1",{children:"Meetings Calendar"}),e.jsx("p",{children:"Failed to load meetings data. Please try refreshing."})]});const c=n.how_to_attend;return e.jsxs("div",{className:"meetings-page animate-fade-in",children:[e.jsxs("div",{className:"page-header",children:[e.jsx("h1",{children:"Meetings Calendar"}),e.jsxs("p",{className:"subtitle",children:["Upcoming ",i," Council meetings with agenda analysis and public participation guidance"]})]}),e.jsxs("div",{className:"meetings-info-banner",children:[e.jsxs("div",{className:"info-stat",children:[e.jsx(F,{size:18}),e.jsxs("span",{children:[e.jsx("strong",{children:u.filter(s=>!s.cancelled).length})," upcoming meetings"]})]}),e.jsxs("div",{className:"info-stat",children:[e.jsx(N,{size:18}),e.jsxs("span",{children:[e.jsx("strong",{children:$})," with spending relevance"]})]}),e.jsxs("div",{className:"info-stat",children:[e.jsx(p,{size:18}),e.jsxs("span",{children:["Updated ",new Date(n.last_updated).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})]})]})]}),e.jsxs("details",{className:"how-to-attend",children:[e.jsxs("summary",{children:[e.jsx(I,{size:18}),e.jsx("span",{children:"How to attend and speak at council meetings"}),e.jsx(v,{size:16,className:"chevron"})]}),e.jsxs("div",{className:"how-to-content",children:[e.jsxs("div",{className:"how-to-grid",children:[e.jsxs("div",{className:"how-to-card",children:[e.jsxs("h4",{children:[e.jsx(y,{size:16})," Attending"]}),e.jsx("p",{children:c.general})]}),e.jsxs("div",{className:"how-to-card",children:[e.jsxs("h4",{children:[e.jsx(b,{size:16})," Speaking"]}),e.jsx("p",{children:c.speak_at_meeting})]}),e.jsxs("div",{className:"how-to-card",children:[e.jsxs("h4",{children:[e.jsx(p,{size:16})," Registration Deadlines"]}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Full Council, Executive, Scrutiny:"})," ",c.deadlines.full_council]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Planning & Licensing:"})," ",c.deadlines.development_control]})]})]}),e.jsxs("div",{className:"how-to-card",children:[e.jsxs("h4",{children:[e.jsx(w,{size:16})," Public Questions"]}),e.jsx("p",{children:c.public_questions})]})]}),e.jsxs("div",{className:"how-to-tips",children:[e.jsx("strong",{children:"Tips:"})," ",c.tips]}),e.jsxs("div",{className:"how-to-contact",children:["Contact: ",e.jsx("a",{href:`mailto:${c.contact}`,children:c.contact})]})]})]}),e.jsxs("div",{className:"meetings-filters",children:[e.jsxs("div",{className:"type-filters",children:[e.jsx(R,{size:16}),e.jsx("button",{className:`filter-pill ${d==="all"?"active":""}`,onClick:()=>g("all"),children:"All"}),P.map(s=>e.jsx("button",{className:`filter-pill ${d===s?"active":""}`,onClick:()=>g(s),style:d===s?{background:m[s],borderColor:m[s]}:{},children:C[s]||s},s))]}),e.jsxs("label",{className:"show-past-toggle",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:s=>k(s.target.checked)}),"Show past & cancelled"]})]}),e.jsxs("div",{className:"meetings-list",children:[u.length===0&&e.jsx("div",{className:"no-meetings",children:"No meetings match your filters."}),u.map(s=>{const a=T===s.id,o=q(s.date),z=o==="Past",f=o==="Today",D=o==="Tomorrow";return e.jsxs("article",{className:`meeting-card ${s.cancelled?"cancelled":""} ${z?"past":""} ${f?"today":""} ${a?"expanded":""}`,onClick:()=>M(a?null:s.id),children:[e.jsxs("div",{className:"meeting-header",children:[e.jsxs("div",{className:"meeting-date-block",children:[e.jsx("span",{className:"meeting-day",children:new Date(s.date+"T00:00:00").getDate()}),e.jsx("span",{className:"meeting-month",children:new Date(s.date+"T00:00:00").toLocaleDateString("en-GB",{month:"short"})})]}),e.jsxs("div",{className:"meeting-info",children:[e.jsxs("div",{className:"meeting-title-row",children:[e.jsx("h3",{className:"meeting-title",children:s.committee}),e.jsx("span",{className:"meeting-type-badge",style:{background:`${m[s.type]}20`,color:m[s.type],borderColor:`${m[s.type]}40`},children:C[s.type]||s.type})]}),e.jsx("div",{className:"meeting-meta",children:s.cancelled?e.jsx("span",{className:"meeting-cancelled-badge",children:"CANCELLED"}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"meta-item",children:[e.jsx(p,{size:14})," ",U(s.time)]}),s.venue&&e.jsxs("span",{className:"meta-item",children:[e.jsx(y,{size:14})," ",s.venue]}),e.jsx("span",{className:`countdown-badge ${f?"today":""} ${D?"soon":""}`,children:o})]})}),s.status==="agenda_published"&&e.jsx("span",{className:"agenda-badge",children:"Agenda Published"})]}),e.jsxs("div",{className:"meeting-indicators",children:[s.doge_relevance&&e.jsx("span",{className:"doge-indicator",title:"Spending relevance identified",children:"Â£"}),e.jsx(v,{size:18,className:`expand-icon ${a?"rotated":""}`})]})]}),a&&!s.cancelled&&e.jsxs("div",{className:"meeting-details",children:[e.jsxs("div",{className:"meeting-detail-section",children:[e.jsx("h4",{children:"Summary"}),e.jsx("p",{children:s.summary})]}),s.agenda_items?.length>0&&e.jsxs("div",{className:"meeting-detail-section",children:[e.jsx("h4",{children:"Agenda Items"}),e.jsx("ul",{className:"agenda-list",children:s.agenda_items.map((h,j)=>e.jsx("li",{children:h},j))})]}),e.jsxs("div",{className:"meeting-detail-section",children:[e.jsx("h4",{children:"Public Relevance"}),e.jsx("p",{children:s.public_relevance})]}),s.doge_relevance&&e.jsxs("div",{className:"meeting-detail-section doge-section",children:[e.jsxs("h4",{children:[e.jsx(N,{size:16})," Spending & Accountability"]}),e.jsx("p",{children:s.doge_relevance})]}),s.speak_deadline&&e.jsxs("div",{className:"speak-deadline",children:[e.jsx(b,{size:14}),e.jsxs("span",{children:["Register to speak by: ",e.jsx("strong",{children:s.speak_deadline})]})]}),s.documents?.length>0&&e.jsxs("div",{className:"meeting-detail-section",children:[e.jsx("h4",{children:"Published Documents"}),e.jsx("div",{className:"doc-list",children:s.documents.map((h,j)=>e.jsxs("span",{className:"doc-badge",children:[e.jsx(w,{size:12})," ",h]},j))})]}),e.jsx("div",{className:"meeting-actions",children:s.link&&e.jsxs("a",{href:s.link,target:"_blank",rel:"noopener noreferrer",className:"meeting-link",onClick:h=>h.stopPropagation(),children:[e.jsx(G,{size:14}),"View on ModernGov"]})})]})]},s.id)})]}),e.jsx("div",{className:"meetings-source",children:e.jsxs("p",{children:["Meeting data sourced from the ",e.jsxs("a",{href:l.moderngov_url||"#",target:"_blank",rel:"noopener noreferrer",children:[i," Council ModernGov portal"]}),". Updated weekly. Agendas are typically published 5 working days before each meeting.",n.last_updated&&` Last checked: ${H(n.last_updated.split("T")[0])}.`]})})]})}export{K as default};
