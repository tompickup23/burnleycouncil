import{j as e}from"./tanstack-BHj98Y4o.js";import{r as z}from"./vendor-BUcjPAt-.js";import{c as P,u as je,a as ye,L as be,D as ae,I as te,d as r,B as K,T as U,e as G,g as fe}from"./index-pGaQqd3_.js";import{R as b,B as V,C as M,X as T,Y as R,T as f,a as q,P as Z,b as ee,c as L,L as re,e as ne,A as ie,d as ce}from"./recharts-DyzHFDWD.js";import{C as Ne}from"./chart-column-S2Au_v7m.js";const _e=[["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M14 6a6 6 0 0 1 6 6v3",key:"1hnv84"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6",key:"9ciidu"}],["rect",{x:"2",y:"15",width:"20",height:"4",rx:"1",key:"g3x8cw"}]],H=P("hard-hat",_e);const ke=[["path",{d:"M10 18v-7",key:"wt116b"}],["path",{d:"M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z",key:"1m329m"}],["path",{d:"M14 18v-7",key:"vav6t3"}],["path",{d:"M18 18v-7",key:"aexdmj"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M6 18v-7",key:"1ivflk"}]],se=P("landmark",ke);const we=[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]],le=P("piggy-bank",we);const Ce=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Me=P("trending-down",Ce);const Te=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],de=P("wallet",Te),E=["#0a84ff","#30d158","#ff9f0a","#ff453a","#bf5af2","#64d2ff","#ffd60a","#ff6482","#ac8e68","#8e8e93","#ff375f","#34c759","#007aff","#5856d6","#af52de"],oe=new Set(["Earmarked Reserves","Management Team","People & Development"]);function Re(v){const i=new Set,l=v.some(d=>d.departments?.["Finance (from 01/04/2025)"]!==void 0);for(const d of v)for(const[p,N]of Object.entries(d.departments||{}))oe.has(p)||l&&(p==="Finance (from 01/04/2025)"||p==="Property (back in-house 01/04/2025)")||N!==0&&N!==null&&N!==void 0&&i.add(p);return l&&!i.has("Finance & Property")&&i.add("Finance & Property"),Array.from(i).sort()}function De(){const v=je(),i=v.council_name||"Council",l=v.council_full_name||"Borough Council",d=v.data_sources?.budgets!==!1,p=v.data_sources?.budget_trends,N=d?["/data/budgets.json","/data/budget_insights.json"]:["/data/budgets_govuk.json","/data/revenue_trends.json"],{data:F,loading:$}=ye(N),[o,w]=F||[null,null],[m,_]=z.useState("revenue"),[t,n]=z.useState(null),[C,W]=z.useState(()=>null);if(z.useEffect(()=>(document.title=`Budget Analysis | ${i} Council Transparency`,()=>{document.title=`${i} Council Transparency`}),[i]),o&&C===null&&W(o.revenue_budgets?.length-1||0),$)return e.jsx(be,{message:"Loading budget data..."});if(!d&&p)return e.jsx(Se,{councilName:i,councilFullName:l,govukData:o,trendsData:w});if(!o)return e.jsx("div",{className:"budgets-page animate-fade-in",children:e.jsxs("header",{className:"page-header",children:[e.jsx("h1",{children:"Budget Analysis"}),e.jsxs("p",{className:"subtitle",children:["Budget data is not yet available for ",l,"."]})]})});const u=o?.revenue_budgets||[],O=o?.capital_programmes||[],j=o?.treasury_and_investment||{},y=o?.insights||{},he=w?.yoy_changes||[],Y=w?.political_highlights||[],S=w?.efficiency_metrics||{},X=u.map(s=>({year:s.financial_year,budget:s.net_revenue_budget/1e6,councilTax:s.council_tax?.council_element??s.council_tax?.[`${v.council_id}_element`]??s.council_tax?.burnley_element??0})),D=u[C]||u[u.length-1],me=D?.departments||{},ue=Re(u),A=u.some(s=>s.departments?.["Finance (from 01/04/2025)"]!==void 0),xe=(s,a)=>{if(a==="Finance & Property"&&A){const h=s.departments["Finance & Property"],B=s.departments["Finance (from 01/04/2025)"],k=s.departments["Property (back in-house 01/04/2025)"];return h!==void 0?h:B!==void 0&&k!==void 0?B+k:null}return s.departments?.[a]??null},Q=Object.entries(me).filter(([s,a])=>a>0&&!oe.has(s)).sort((s,a)=>a[1]-s[1]).map(([s,a],h)=>({name:s.replace("(from 01/04/2025)","").replace("(back in-house 01/04/2025)","").trim(),value:a,color:E[h%E.length]})),x=O[O.length-1],J=x?Object.entries(x.categories).map(([s,a])=>({name:s.length>15?s.substring(0,15)+"...":s,fullName:s,value:a.total/1e6,note:a.note||"",color:E[index%E.length]})):[],pe=O.map(s=>({period:s.budget_book_year,total:s.total_all_schemes/1e6})),c=D?.funding_sources||{},I=[{name:"Council Tax",value:Math.abs(c.council_tax||0)/1e6,color:"#0a84ff"},{name:"Business Rates",value:(Math.abs(c.business_rate_baseline||0)+Math.abs(c.additional_business_rates||0))/1e6,color:"#30d158"},{name:"Government Grants",value:(Math.abs(c.revenue_support_grant||0)+Math.abs(c.new_homes_bonus||0)+Math.abs(c.recovery_grant||0)+Math.abs(c.funding_guarantee_grant||0)+Math.abs(c.services_grant||0)+Math.abs(c.services_grant_2022||0)+Math.abs(c.lower_tier_services_grant||0)+Math.abs(c.local_council_tax_support_grant||0)+Math.abs(c.domestic_abuse_grant||0)+Math.abs(c.ni_contribution_grant||0))/1e6,color:"#ff9f0a"},{name:"Other",value:(Math.abs(c.renewable_energy_schemes||0)+Math.abs(c.business_rates_multiplier_grant||0)+Math.abs(c.parish_precepts||0))/1e6,color:"#8e8e93"}].filter(s=>s.value>0);return e.jsxs("div",{className:"budgets-page animate-fade-in",children:[e.jsxs("header",{className:"page-header",children:[e.jsx("h1",{children:"Budget Analysis"}),e.jsxs("p",{className:"subtitle",children:["Comprehensive analysis of ",l,"'s revenue and capital budgets"]}),e.jsx(ae,{source:"Budget data",compact:!0})]}),e.jsxs("div",{className:"budget-explainer",children:[e.jsx(te,{size:18}),e.jsxs("div",{children:[e.jsx("strong",{children:"Revenue vs Capital:"})," The council has two separate budgets. The ",e.jsx("strong",{children:"Revenue Budget"})," (",r(y.revenue_vs_capital?.current_revenue,!0),") covers day-to-day running costs — staff, services, utilities — funded by council tax and grants. The ",e.jsx("strong",{children:"Capital Programme"})," (",r(y.revenue_vs_capital?.current_capital_5yr,!0)," over 5 years) covers long-term investment in buildings, infrastructure, and equipment — funded by borrowing and capital grants."]})]}),e.jsxs("nav",{className:"budget-tabs",children:[e.jsxs("button",{className:`tab-btn ${m==="revenue"?"active":""}`,onClick:()=>_("revenue"),children:[e.jsx(de,{size:18}),"Revenue Budget"]}),e.jsxs("button",{className:`tab-btn ${m==="departments"?"active":""}`,onClick:()=>_("departments"),children:[e.jsx(K,{size:18}),"Departmental Breakdown"]}),e.jsxs("button",{className:`tab-btn ${m==="capital"?"active":""}`,onClick:()=>_("capital"),children:[e.jsx(H,{size:18}),"Capital Programme"]}),e.jsxs("button",{className:`tab-btn ${m==="treasury"?"active":""}`,onClick:()=>_("treasury"),children:[e.jsx(se,{size:18}),"Treasury & Investment"]})]}),m==="revenue"&&e.jsxs("div",{className:"tab-content",children:[e.jsxs("section",{className:"metrics-grid",children:[e.jsxs("div",{className:"metric-card highlight",children:[e.jsx("div",{className:"metric-icon",children:e.jsx(le,{size:24})}),e.jsxs("div",{className:"metric-content",children:[e.jsx("span",{className:"metric-value",children:r(S.latest_budget,!0)}),e.jsxs("span",{className:"metric-label",children:[S.latest_year," Net Revenue Budget"]})]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon growth",children:e.jsx(U,{size:24})}),e.jsxs("div",{className:"metric-content",children:[e.jsxs("span",{className:"metric-value text-orange",children:["+",G(S.total_budget_growth_pct)]}),e.jsxs("span",{className:"metric-label",children:[S.years_covered,"-Year Budget Growth"]})]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon",children:e.jsx(K,{size:24})}),e.jsxs("div",{className:"metric-content",children:[e.jsxs("span",{className:"metric-value",children:["+",G(S.avg_annual_growth_pct)]}),e.jsx("span",{className:"metric-label",children:"Average Annual Growth"})]})]})]}),e.jsxs("section",{className:"chart-section",children:[e.jsx("h2",{children:"Revenue Budget Trend"}),e.jsx("p",{className:"section-note",children:"Net revenue budget — the cost of running day-to-day council services"}),e.jsx("div",{className:"chart-card",children:e.jsx(b,{width:"100%",height:300,children:e.jsxs(V,{data:X,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(M,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(T,{dataKey:"year",tick:{fill:"var(--text-secondary)",fontSize:12}}),e.jsx(R,{tick:{fill:"var(--text-secondary)",fontSize:12},tickFormatter:s=>`£${s}M`}),e.jsx(f,{contentStyle:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px"},formatter:s=>[`£${s.toFixed(2)}M`,"Net Revenue Budget"]}),e.jsx(q,{dataKey:"budget",fill:"var(--accent-blue)",radius:[4,4,0,0]})]})})})]}),e.jsxs("section",{className:"yoy-section",children:[e.jsx("h2",{children:"Year-on-Year Changes"}),e.jsx("div",{className:"yoy-grid",children:he.map((s,a)=>e.jsxs("div",{className:`yoy-card ${s.change_amount>0?"increase":"decrease"}`,children:[e.jsxs("div",{className:"yoy-header",children:[e.jsxs("span",{className:"yoy-years",children:[s.from_year," → ",s.to_year]}),s.change_amount>0?e.jsx(U,{size:20,className:"text-red"}):e.jsx(Me,{size:20,className:"text-green"})]}),e.jsxs("div",{className:"yoy-change",children:[e.jsxs("span",{className:`change-amount ${s.change_amount>0?"text-red":"text-green"}`,children:[s.change_amount>0?"+":"",r(s.change_amount,!0)]}),e.jsxs("span",{className:"change-percent",children:["(",s.change_percent>0?"+":"",s.change_percent.toFixed(1),"%)"]})]}),e.jsxs("div",{className:"yoy-detail text-secondary",children:[r(s.previous_budget,!0)," → ",r(s.current_budget,!0)]})]},a))})]}),e.jsxs("section",{className:"chart-section",children:[e.jsxs("h2",{children:["How the Revenue Budget is Funded (",D?.financial_year,")"]}),e.jsxs("div",{className:"chart-card funding-chart",children:[e.jsx("div",{className:"funding-visual",children:e.jsx(b,{width:"100%",height:250,children:e.jsxs(Z,{children:[e.jsx(ee,{data:I,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,dataKey:"value",label:({name:s,value:a})=>`${s}: £${a.toFixed(1)}M`,labelLine:!0,children:I.map((s,a)=>e.jsx(L,{fill:s.color},`cell-${a}`))}),e.jsx(f,{contentStyle:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px"},formatter:s=>[`£${s.toFixed(2)}M`]})]})})}),e.jsx("div",{className:"funding-breakdown",children:I.map((s,a)=>e.jsxs("div",{className:"funding-item",children:[e.jsx("span",{className:"funding-dot",style:{background:s.color}}),e.jsx("span",{className:"funding-name",children:s.name}),e.jsxs("span",{className:"funding-value",children:["£",s.value.toFixed(1),"M"]})]},a))})]})]}),e.jsxs("section",{className:"chart-section",children:[e.jsxs("h2",{children:["Council Tax (",i," Element) Band D"]}),e.jsxs("div",{className:"chart-card",children:[e.jsx(b,{width:"100%",height:250,children:e.jsxs(re,{data:X.filter(s=>s.councilTax>0),margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(M,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(T,{dataKey:"year",tick:{fill:"var(--text-secondary)",fontSize:12}}),e.jsx(R,{domain:["dataMin - 10","dataMax + 10"],tick:{fill:"var(--text-secondary)",fontSize:12},tickFormatter:s=>`£${s}`}),e.jsx(f,{contentStyle:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px"},formatter:s=>[`£${s.toFixed(2)}`,`Band D (${i})`]}),e.jsx(ne,{type:"monotone",dataKey:"councilTax",stroke:"var(--accent-green)",strokeWidth:2,dot:{fill:"var(--accent-green)",r:4}})]})}),e.jsxs("p",{className:"chart-note text-secondary",children:["This is the ",l," element only. Total Band D council tax includes Lancashire County Council, police, and fire precepts."]})]})]}),Y.length>0&&e.jsxs("section",{className:"highlights-section",children:[e.jsx("h2",{children:"Key Political Points"}),e.jsx("div",{className:"highlights-grid",children:Y.map((s,a)=>e.jsxs("div",{className:"highlight-card",children:[e.jsx(fe,{size:20,className:"highlight-icon"}),e.jsx("p",{children:s.description})]},a))})]})]}),m==="departments"&&e.jsxs("div",{className:"tab-content",children:[e.jsxs("div",{className:"year-selector",children:[e.jsx("span",{className:"year-label",children:"Showing:"}),u.map((s,a)=>e.jsx("button",{className:`year-btn ${C===a?"active":""}`,onClick:()=>W(a),children:s.financial_year},a))]}),e.jsxs("section",{className:"chart-section",children:[e.jsxs("h2",{children:["Department Spending — ",D?.financial_year]}),e.jsx("p",{className:"section-note",children:"Net revenue budget allocation by department (excludes zero-budget and negative departments)"}),e.jsx("div",{className:"chart-card",children:e.jsx(b,{width:"100%",height:350,children:e.jsxs(Z,{children:[e.jsx(ee,{data:Q,cx:"50%",cy:"50%",outerRadius:130,dataKey:"value",label:({name:s,value:a})=>`${s}: ${r(a,!0)}`,labelLine:!0,children:Q.map((s,a)=>e.jsx(L,{fill:s.color},`cell-${a}`))}),e.jsx(f,{contentStyle:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px"},formatter:s=>[r(s,!0)]})]})})})]}),e.jsxs("section",{className:"table-section",children:[e.jsx("h2",{children:"Departmental Budget Comparison"}),e.jsx("p",{className:"section-note",children:"All figures are net revenue budget (£). Negative values indicate net income generators."}),e.jsx("div",{className:"table-wrapper",children:e.jsxs("table",{className:"budget-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Department"}),u.map(s=>e.jsx("th",{children:s.financial_year},s.financial_year)),e.jsx("th",{children:"Change"})]})}),e.jsxs("tbody",{children:[ue.map(s=>{const a=u.map(g=>xe(g,s)),h=a.find(g=>g!==null&&g!==0),B=a[a.length-1],k=h&&B?((B-h)/Math.abs(h)*100).toFixed(0):null,ge=s==="Finance & Property"&&A?"Finance & Property *":s;return e.jsxs("tr",{className:t===s?"expanded":"",children:[e.jsx("td",{className:"dept-name",onClick:()=>n(t===s?null:s),children:ge}),a.map((g,ve)=>e.jsx("td",{className:g<0?"negative":"",children:g!==null&&g!==0?r(g,!0):"-"},ve)),e.jsx("td",{className:`change-cell ${k>0?"text-red":k<0?"text-green":""}`,children:k!==null?`${k>0?"+":""}${k}%`:"-"})]},s)}),e.jsxs("tr",{className:"reserves-row",children:[e.jsx("td",{className:"dept-name",children:"Earmarked Reserves"}),u.map((s,a)=>e.jsx("td",{className:s.departments["Earmarked Reserves"]<0?"negative":"",children:r(s.departments["Earmarked Reserves"],!0)},a)),e.jsx("td",{})]}),e.jsxs("tr",{className:"total-row",children:[e.jsx("td",{className:"dept-name",children:e.jsx("strong",{children:"Total Net Revenue Budget"})}),u.map((s,a)=>e.jsx("td",{children:e.jsx("strong",{children:r(s.net_revenue_budget,!0)})},a)),e.jsx("td",{className:"text-red",children:e.jsxs("strong",{children:["+",G(S.total_budget_growth_pct)]})})]})]})]})}),e.jsxs("p",{className:"table-note text-secondary",children:[A&&"* Finance & Property split into separate departments in 2025/26. Combined figure shown for comparison. ","Source: ",i," Council Budget Books."]})]}),e.jsxs("section",{className:"growth-section",children:[e.jsx("h2",{children:"Fastest Growing Departments (2021/22 → 2025/26)"}),e.jsx("div",{className:"growth-grid",children:Object.entries(y.departmental_growth||{}).map(([s,a],h)=>e.jsxs("div",{className:"growth-card",children:[e.jsxs("div",{className:"growth-rank",children:["#",h+1]}),e.jsxs("div",{className:"growth-info",children:[e.jsx("h4",{children:s}),e.jsxs("div",{className:"growth-values",children:[e.jsx("span",{className:"growth-from",children:r(a.from,!0)}),e.jsx("span",{className:"growth-arrow",children:"→"}),e.jsx("span",{className:"growth-to",children:r(a.to,!0)})]})]}),e.jsxs("div",{className:`growth-pct ${a.growth_pct>50?"high":""}`,children:["+",a.growth_pct.toFixed(0),"%"]})]},s))})]})]}),m==="capital"&&e.jsxs("div",{className:"tab-content",children:[e.jsxs("div",{className:"budget-explainer capital",children:[e.jsx(H,{size:18}),e.jsxs("div",{children:[e.jsx("strong",{children:"What is the Capital Programme?"})," Unlike the revenue budget (day-to-day costs), the capital programme covers investment in long-term assets — buildings, infrastructure, vehicles, and major equipment. It's funded by borrowing (which must be repaid from revenue), government capital grants, and proceeds from selling council assets."]})]}),e.jsxs("section",{className:"metrics-grid",children:[e.jsxs("div",{className:"metric-card highlight",children:[e.jsx("div",{className:"metric-icon",children:e.jsx(H,{size:24})}),e.jsxs("div",{className:"metric-content",children:[e.jsx("span",{className:"metric-value",children:r(x?.total_all_schemes,!0)}),e.jsxs("span",{className:"metric-label",children:[x?.programme_period," Capital Programme"]})]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon growth",children:e.jsx(Ne,{size:24})}),e.jsxs("div",{className:"metric-content",children:[e.jsx("span",{className:"metric-value",children:r(x?.year_totals?.[Object.keys(x?.year_totals||{})[0]],!0)}),e.jsx("span",{className:"metric-label",children:"Current Year Capital Spend"})]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon",children:e.jsx(K,{size:24})}),e.jsxs("div",{className:"metric-content",children:[e.jsx("span",{className:"metric-value",children:"5"}),e.jsx("span",{className:"metric-label",children:"Investment Categories"})]})]})]}),e.jsxs("section",{className:"chart-section",children:[e.jsx("h2",{children:"Current Capital Programme by Category"}),e.jsxs("p",{className:"section-note",children:[x?.programme_period," — Total: ",r(x?.total_all_schemes,!0)]}),e.jsx("div",{className:"chart-card",children:e.jsx(b,{width:"100%",height:300,children:e.jsxs(V,{data:J,layout:"vertical",margin:{top:10,right:30,left:10,bottom:5},children:[e.jsx(M,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(T,{type:"number",tick:{fill:"var(--text-secondary)",fontSize:12},tickFormatter:s=>`£${s}M`}),e.jsx(R,{dataKey:"name",type:"category",tick:{fill:"var(--text-secondary)",fontSize:11},width:120}),e.jsx(f,{contentStyle:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px"},formatter:(s,a,h)=>[`£${s.toFixed(2)}M`,h.payload.fullName]}),e.jsx(q,{dataKey:"value",radius:[0,4,4,0],children:J.map((s,a)=>e.jsx(L,{fill:s.color},`cell-${a}`))})]})})})]}),e.jsxs("section",{className:"chart-section",children:[e.jsx("h2",{children:"Capital Programme Size Over Time"}),e.jsx("p",{className:"section-note",children:"Total 5-year programme as approved in each budget book"}),e.jsx("div",{className:"chart-card",children:e.jsx(b,{width:"100%",height:250,children:e.jsxs(ie,{data:pe,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(M,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(T,{dataKey:"period",tick:{fill:"var(--text-secondary)",fontSize:12}}),e.jsx(R,{tick:{fill:"var(--text-secondary)",fontSize:12},tickFormatter:s=>`£${s}M`}),e.jsx(f,{contentStyle:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px"},formatter:s=>[`£${s.toFixed(1)}M`,"5-Year Programme"]}),e.jsx(ce,{type:"monotone",dataKey:"total",stroke:"var(--accent-green)",fill:"rgba(48, 209, 88, 0.15)",strokeWidth:2})]})})})]}),e.jsxs("section",{className:"schemes-section",children:[e.jsx("h2",{children:"Major Capital Schemes"}),e.jsx("div",{className:"schemes-grid",children:(j.notable_investments||[]).map((s,a)=>e.jsxs("div",{className:"scheme-card",children:[e.jsx("div",{className:"scheme-value",children:r(s.value,!0)}),e.jsx("h4",{children:s.name}),e.jsx("p",{className:"text-secondary",children:s.note})]},a))})]}),x&&e.jsxs("section",{className:"capital-details-section",children:[e.jsxs("h2",{children:["Category Breakdown (",x.budget_book_year,")"]}),e.jsx("div",{className:"capital-details-grid",children:Object.entries(x.categories).map(([s,a])=>e.jsxs("div",{className:"capital-detail-card",children:[e.jsx("h4",{children:s}),e.jsx("span",{className:"capital-detail-total",children:r(a.total,!0)}),a.note&&e.jsx("p",{className:"text-secondary",children:a.note})]},s))})]})]}),m==="treasury"&&e.jsxs("div",{className:"tab-content",children:[e.jsxs("div",{className:"budget-explainer treasury",children:[e.jsx(se,{size:18}),e.jsxs("div",{children:[e.jsx("strong",{children:"Treasury Management & Investment Strategy:"})," The council manages public money through carefully regulated borrowing and investment activities. All decisions must comply with the CIPFA Code of Practice for Treasury Management and the council's approved strategies."]})]}),e.jsxs("section",{className:"treasury-grid",children:[j.key_context?.borrowing&&e.jsxs("div",{className:"treasury-card",children:[e.jsx("h3",{children:"Borrowing"}),e.jsx("p",{children:j.key_context.borrowing})]}),j.key_context?.investments&&e.jsxs("div",{className:"treasury-card",children:[e.jsx("h3",{children:"Investments"}),e.jsx("p",{children:j.key_context.investments})]}),j.key_context?.mrp&&e.jsxs("div",{className:"treasury-card",children:[e.jsx("h3",{children:"Minimum Revenue Provision (MRP)"}),e.jsx("p",{children:j.key_context.mrp})]}),j.key_context?.charter_walk&&e.jsxs("div",{className:"treasury-card",children:[e.jsx("h3",{children:"Charter Walk Investment"}),e.jsx("p",{children:j.key_context.charter_walk})]})]}),e.jsxs("section",{className:"context-section",children:[e.jsx("h2",{children:"How Council Finance Works"}),e.jsxs("div",{className:"context-card",children:[e.jsxs("div",{className:"context-item",children:[e.jsx("h4",{children:"Revenue Budget"}),e.jsxs("p",{children:["The day-to-day running costs of the council — staff salaries, service delivery, utilities, contracts. Currently ",r(y.revenue_vs_capital?.current_revenue,!0)," per year. Funded by council tax (",y.funding_dependency?.council_tax_pct,"%), business rates (",y.funding_dependency?.business_rates_pct,"%), and government grants (",y.funding_dependency?.government_grants_pct,"%)."]})]}),e.jsxs("div",{className:"context-item",children:[e.jsx("h4",{children:"Capital Programme"}),e.jsxs("p",{children:["Long-term investment in assets: buildings, infrastructure, vehicles, equipment. Currently ",r(y.revenue_vs_capital?.current_capital_5yr,!0)," over 5 years. Funded by prudential borrowing (which must be repaid from revenue via MRP), government capital grants (Better Care, Levelling Up, Heritage Lottery), and capital receipts from asset sales."]})]}),e.jsxs("div",{className:"context-item",children:[e.jsx("h4",{children:"Treasury Management"}),e.jsx("p",{children:"The council's treasury function manages cash flow, borrowing, and investments. Borrowing must comply with Prudential Indicators approved by Full Council. Investments prioritise security first, then liquidity, then yield. The MRP charge on revenue has grown as capital spending increased."})]}),e.jsxs("div",{className:"context-item",children:[e.jsx("h4",{children:"Reserves & Balances"}),e.jsx("p",{children:"Reserves are the council's financial cushion. General Fund reserves provide a safety net for emergencies. Earmarked reserves are set aside for specific purposes. In 2025/26, earmarked reserves were slashed from £1.33M to just £2,250 — raising concerns about financial resilience."})]}),e.jsxs("div",{className:"context-item",children:[e.jsx("h4",{children:"External Spending Data"}),e.jsx("p",{children:"The spending data published under the Transparency Code shows external payments to suppliers — invoices over £500, contracts, and purchase cards. This includes BOTH revenue payments (e.g. Liberata contract) AND capital payments (e.g. the £19.8M Geldards payment for Pioneer Place construction). It does NOT show internal costs like staff salaries."})]}),e.jsxs("div",{className:"context-item",children:[e.jsx("h4",{children:"Key Risks"}),e.jsx("p",{children:"Rising MRP costs from past capital borrowing eating into revenue budget. Declining government grants (New Homes Bonus fell from £694K to £239K). Near-exhaustion of earmarked reserves (£1.33M → £2,250 in one year). Council tax increases capped by referendum limits (typically 2-3% for district councils)."})]})]})]}),e.jsxs("section",{className:"trends-section",children:[e.jsx("h2",{children:"Key Budget Trends"}),e.jsx("div",{className:"trends-grid",children:(y.key_trends||[]).map((s,a)=>e.jsxs("div",{className:"trend-card",children:[e.jsx("span",{className:"trend-number",children:a+1}),e.jsx("p",{children:s})]},a))})]})]})]})}function Se({councilName:v,councilFullName:i,govukData:l,trendsData:d}){const p=l?.revenue_summary?.service_expenditure?Object.entries(l.revenue_summary.service_expenditure).filter(([t,n])=>n.relevant_to_districts&&n.value_pounds>0&&t!=="TOTAL SERVICE EXPENDITURE").sort((t,n)=>n[1].value_pounds-t[1].value_pounds).map(([t,n],C)=>({name:t.length>25?t.substring(0,22)+"...":t,fullName:t,value:n.value_pounds/1e6,color:E[C%E.length]})):[],N=l?.revenue_summary?.service_expenditure?.["TOTAL SERVICE EXPENDITURE"]?.value_pounds||0,F=l?.revenue_summary?.key_financials?.["NET REVENUE EXPENDITURE"]?.value_pounds||0,$=l?.revenue_summary?.key_financials?.["COUNCIL TAX REQUIREMENT"]?.value_pounds||0,o=d?.years?d.years.map(t=>{const n=d.by_year?.[t]?.summary||{};return{year:t.replace("-","/"),total:(n["Total Net Current Expenditure"]||0)/1e3,housing:(n["Housing (GF & HRA)"]||0)/1e3,cultural:(n["Cultural Services"]||0)/1e3,environmental:(n["Environmental Services"]||0)/1e3,planning:(n["Planning & Development"]||0)/1e3,central:(n["Central Services"]||0)/1e3}}):[],w=["environmental","central","cultural","housing","planning"],m={environmental:"Environmental",central:"Central Services",cultural:"Cultural",housing:"Housing",planning:"Planning"},_={environmental:"#30d158",central:"#0a84ff",cultural:"#ff9f0a",housing:"#bf5af2",planning:"#64d2ff"};return e.jsxs("div",{className:"budgets-page animate-fade-in",children:[e.jsxs("header",{className:"page-header",children:[e.jsx("h1",{children:"Budget Overview"}),e.jsxs("p",{className:"subtitle",children:["Revenue outturn data for ",i," from GOV.UK MHCLG returns"]}),e.jsx(ae,{source:"GOV.UK Revenue Outturn",compact:!0})]}),e.jsxs("div",{className:"budget-explainer",children:[e.jsx(te,{size:18}),e.jsxs("div",{children:[e.jsx("strong",{children:"About this data:"})," Detailed budget book analysis is not yet available for ",i,". This page shows official revenue outturn data published by the Ministry of Housing, Communities and Local Government (MHCLG) under the Open Government Licence. Outturn figures show ",e.jsx("em",{children:"actual spend"}),", not budget estimates."]})]}),e.jsxs("section",{className:"metrics-grid",children:[N>0&&e.jsxs("div",{className:"metric-card highlight",children:[e.jsx("div",{className:"metric-icon",children:e.jsx(le,{size:24})}),e.jsxs("div",{className:"metric-content",children:[e.jsx("span",{className:"metric-value",children:r(N,!0)}),e.jsxs("span",{className:"metric-label",children:[l?.financial_year," Service Expenditure"]})]})]}),F>0&&e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon growth",children:e.jsx(U,{size:24})}),e.jsxs("div",{className:"metric-content",children:[e.jsx("span",{className:"metric-value",children:r(F,!0)}),e.jsx("span",{className:"metric-label",children:"Net Revenue Expenditure"})]})]}),$>0&&e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon",children:e.jsx(de,{size:24})}),e.jsxs("div",{className:"metric-content",children:[e.jsx("span",{className:"metric-value",children:r($,!0)}),e.jsx("span",{className:"metric-label",children:"Council Tax Requirement"})]})]})]}),p.length>0&&e.jsxs("section",{className:"chart-section",children:[e.jsxs("h2",{children:["Service Expenditure (",l?.financial_year,")"]}),e.jsx("p",{className:"section-note",children:"Actual outturn spend by service area — district-relevant services only"}),e.jsx("div",{className:"chart-card",children:e.jsx(b,{width:"100%",height:300,children:e.jsxs(V,{data:p,layout:"vertical",margin:{top:10,right:30,left:10,bottom:5},children:[e.jsx(M,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(T,{type:"number",tick:{fill:"var(--text-secondary)",fontSize:12},tickFormatter:t=>`£${t.toFixed(1)}M`}),e.jsx(R,{dataKey:"name",type:"category",tick:{fill:"var(--text-secondary)",fontSize:11},width:160}),e.jsx(f,{contentStyle:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px"},formatter:(t,n,C)=>[`£${t.toFixed(2)}M`,C.payload.fullName]}),e.jsx(q,{dataKey:"value",radius:[0,4,4,0],children:p.map((t,n)=>e.jsx(L,{fill:t.color},`cell-${n}`))})]})})})]}),o.length>0&&e.jsxs("section",{className:"chart-section",children:[e.jsxs("h2",{children:["Revenue Trend (",d?.years?.[0]," to ",d?.years?.[d.years.length-1],")"]}),e.jsxs("p",{className:"section-note",children:["Service expenditure breakdown over ",d?.year_count," years (£ millions, GOV.UK outturn)"]}),e.jsxs("div",{className:"chart-card",children:[e.jsx(b,{width:"100%",height:350,children:e.jsxs(ie,{data:o,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(M,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(T,{dataKey:"year",tick:{fill:"var(--text-secondary)",fontSize:11}}),e.jsx(R,{tick:{fill:"var(--text-secondary)",fontSize:12},tickFormatter:t=>`£${t}M`}),e.jsx(f,{contentStyle:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px"},formatter:(t,n)=>[`£${t.toFixed(2)}M`,m[n]||n]}),w.map(t=>e.jsx(ce,{type:"monotone",dataKey:t,stackId:"1",stroke:_[t],fill:_[t],fillOpacity:.4},t))]})}),e.jsx("div",{className:"funding-breakdown",style:{marginTop:"var(--space-md)"},children:w.map(t=>e.jsxs("div",{className:"funding-item",children:[e.jsx("span",{className:"funding-dot",style:{background:_[t]}}),e.jsx("span",{className:"funding-name",children:m[t]})]},t))})]})]}),o.length>0&&e.jsxs("section",{className:"chart-section",children:[e.jsx("h2",{children:"Total Net Current Expenditure Trend"}),e.jsx("p",{className:"section-note",children:"Includes housing benefit, parish precepts, and all service areas"}),e.jsx("div",{className:"chart-card",children:e.jsx(b,{width:"100%",height:250,children:e.jsxs(re,{data:o,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(M,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(T,{dataKey:"year",tick:{fill:"var(--text-secondary)",fontSize:12}}),e.jsx(R,{tick:{fill:"var(--text-secondary)",fontSize:12},tickFormatter:t=>`£${t}M`}),e.jsx(f,{contentStyle:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px"},formatter:t=>[`£${t.toFixed(1)}M`,"Net Current Expenditure"]}),e.jsx(ne,{type:"monotone",dataKey:"total",stroke:"var(--accent-blue)",strokeWidth:2,dot:{fill:"var(--accent-blue)",r:4}})]})})})]}),e.jsxs("section",{className:"context-section",children:[e.jsx("h2",{children:"About This Data"}),e.jsxs("div",{className:"context-card",children:[e.jsxs("div",{className:"context-item",children:[e.jsx("h4",{children:"Source"}),e.jsxs("p",{children:["Revenue Outturn data published by the Ministry of Housing, Communities and Local Government (MHCLG). This is official, certified data submitted by ",i," under statutory reporting requirements. Licensed under the Open Government Licence v3.0."]})]}),e.jsxs("div",{className:"context-item",children:[e.jsx("h4",{children:"What's Included"}),e.jsxs("p",{children:["Service expenditure covers the main areas of council spending: housing, environmental services, planning, cultural services, highways, and central administration. Figures show ",e.jsx("em",{children:"actual outturn"})," (what was really spent), not budget estimates. Non-district services (education, police, fire, adult social care) are excluded as they are provided by Lancashire County Council."]})]}),e.jsxs("div",{className:"context-item",children:[e.jsx("h4",{children:"Detailed Budgets Coming Soon"}),e.jsxs("p",{children:["We're working on extracting detailed budget book data for ",i,", which will provide departmental breakdowns, capital programme details, treasury management information, and year-on-year budget comparisons similar to other councils on this site."]})]})]})]})]})}export{De as default};
