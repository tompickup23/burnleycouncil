import{j as s}from"./tanstack-BHj98Y4o.js";import{h as P,r as F,L as x}from"./vendor-BUcjPAt-.js";import{c as I,u as V,a as K,L as M,g as _,B as k,h as g,d as t,j,e as Q,F as G,C as v,f as h,M as H,U as C}from"./index-pGaQqd3_.js";import{A as z}from"./arrow-left-CmPEGtry.js";import{C as p}from"./circle-check-big-BQp6i6OH.js";import{R as S,B as L,C as T,X as A,Y as w,T as $,a as D}from"./recharts-DyzHFDWD.js";import{E as Y}from"./external-link-BC31L8iP.js";const X=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],W=I("briefcase",X);const J=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],d=I("circle-x",J),B={clean:"#30d158",low:"#0a84ff",medium:"#ffd60a",high:"#ff9f0a",critical:"#ff453a"},R={critical:"#ff453a",high:"#ff9f0a",medium:"#ffd60a",low:"#0a84ff",info:"#8e8e93"},q={background:"rgba(28, 28, 30, 0.95)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"10px",boxShadow:"0 8px 32px rgba(0,0,0,0.4)",padding:"12px 16px"};function ns(){const m=V().council_name||"Council",{supplierId:O}=P(),{data:U,loading:E}=K("/data/supplier_profiles.json"),r=U?.profiles?.find(e=>e.id===O);if(F.useEffect(()=>(r?document.title=`${r.name} | Supplier Profile | ${m} Council Transparency`:document.title=`Supplier Profile | ${m} Council Transparency`,()=>{document.title=`${m} Council Transparency | Where Your Money Goes`}),[r,m]),E)return s.jsx(M,{message:"Loading supplier profile..."});if(!r)return s.jsxs("div",{className:"supplier-view animate-fade-in",children:[s.jsxs(x,{to:"/suppliers",className:"back-button",children:[s.jsx(z,{size:18})," Back to Suppliers"]}),s.jsxs("div",{className:"supplier-not-found",children:[s.jsx(_,{size:48}),s.jsx("h2",{children:"Supplier not found"}),s.jsx("p",{children:"The supplier profile you are looking for does not exist or has been removed."}),s.jsx(x,{to:"/suppliers",className:"not-found-link",children:"View all suppliers"})]})]});const{spending:c,companies_house:a,compliance:l,governance:n}=r,o=l?B[l.risk_level]||B.low:null,u=c?.by_year?Object.entries(c.by_year).map(([e,i])=>({year:e,amount:i})).sort((e,i)=>e.year.localeCompare(i.year)):[],N=c?.by_quarter?Object.entries(c.by_quarter).map(([e,i])=>({quarter:`Q${e}`,amount:i})).sort((e,i)=>Number(e.quarter.replace("Q",""))-Number(i.quarter.replace("Q",""))):[],b=a?.status?a.status.replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase()):null,y=a?.status==="active";return a?.dissolved!=null,s.jsxs("div",{className:"supplier-view animate-fade-in",children:[s.jsxs(x,{to:"/suppliers",className:"back-button",children:[s.jsx(z,{size:18})," Back to Suppliers"]}),s.jsxs("header",{className:"supplier-hero",children:[s.jsxs("div",{className:"hero-title-row",children:[s.jsxs("div",{className:"hero-titles",children:[s.jsx("h1",{children:r.name}),a&&a.legal_name&&a.legal_name!==r.name&&s.jsxs("p",{className:"legal-name",children:[s.jsx(k,{size:16}),"Legal name: ",a.legal_name]})]}),s.jsxs("div",{className:"hero-badges",children:[b&&s.jsxs("span",{className:`status-badge ${y?"active":"inactive"}`,children:[y?s.jsx(p,{size:14}):s.jsx(d,{size:14}),b]}),l&&s.jsxs("span",{className:"risk-badge",style:{background:`${o}18`,color:o,borderColor:`${o}40`},children:[s.jsx(g,{size:14}),l.risk_level.charAt(0).toUpperCase()+l.risk_level.slice(1)," Risk"]})]})]}),r.aliases&&r.aliases.length>0&&s.jsxs("div",{className:"aliases",children:[s.jsx("span",{className:"aliases-label",children:"Also known as:"}),r.aliases.map((e,i)=>s.jsx("span",{className:"alias-tag",children:e},i))]})]}),s.jsxs("section",{className:"supplier-stats-grid",children:[s.jsxs("div",{className:"supplier-stat-card highlight",children:[s.jsx("span",{className:"supplier-stat-value",children:t(c?.total_all_councils,!0)}),s.jsx("span",{className:"supplier-stat-label",children:"Total Spend (All Councils)"})]}),s.jsxs("div",{className:"supplier-stat-card",children:[s.jsx("span",{className:"supplier-stat-value",children:j(c?.transaction_count)}),s.jsx("span",{className:"supplier-stat-label",children:"Transactions"})]}),s.jsxs("div",{className:"supplier-stat-card",children:[s.jsx("span",{className:"supplier-stat-value",children:t(c?.avg_payment,!0)}),s.jsx("span",{className:"supplier-stat-label",children:"Average Payment"})]}),s.jsxs("div",{className:"supplier-stat-card",children:[s.jsx("span",{className:"supplier-stat-value",children:t(c?.max_payment,!0)}),s.jsx("span",{className:"supplier-stat-label",children:"Max Payment"})]}),s.jsxs("div",{className:"supplier-stat-card",children:[s.jsx("span",{className:"supplier-stat-value",children:j(c?.councils_count)}),s.jsx("span",{className:"supplier-stat-label",children:"Councils Supplying"})]}),s.jsxs("div",{className:"supplier-stat-card",children:[s.jsx("span",{className:"supplier-stat-value",children:r.metadata?.data_quality!=null?Q(r.metadata.data_quality*100,0):"-"}),s.jsx("span",{className:"supplier-stat-label",children:"Data Quality"})]})]}),(u.length>0||N.length>0)&&s.jsxs("section",{className:"supplier-charts",children:[u.length>0&&s.jsxs("div",{className:"supplier-chart-card",children:[s.jsx("h3",{children:"Spending by Year"}),s.jsx(S,{width:"100%",height:280,children:s.jsxs(L,{data:u,margin:{top:10,right:20,left:10,bottom:5},children:[s.jsx(T,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.04)"}),s.jsx(A,{dataKey:"year",tick:{fill:"var(--text-tertiary)",fontSize:11},axisLine:!1,tickLine:!1}),s.jsx(w,{tick:{fill:"var(--text-tertiary)",fontSize:11},tickFormatter:e=>t(e,!0),axisLine:!1,tickLine:!1}),s.jsx($,{contentStyle:q,formatter:e=>[t(e),"Spend"],labelFormatter:e=>`FY ${e}`}),s.jsx(D,{dataKey:"amount",fill:"#0a84ff",radius:[6,6,0,0]})]})})]}),N.length>0&&s.jsxs("div",{className:"supplier-chart-card",children:[s.jsx("h3",{children:"Spending by Quarter"}),s.jsx(S,{width:"100%",height:280,children:s.jsxs(L,{data:N,margin:{top:10,right:20,left:10,bottom:5},children:[s.jsx(T,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.04)"}),s.jsx(A,{dataKey:"quarter",tick:{fill:"var(--text-tertiary)",fontSize:11},axisLine:!1,tickLine:!1}),s.jsx(w,{tick:{fill:"var(--text-tertiary)",fontSize:11},tickFormatter:e=>t(e,!0),axisLine:!1,tickLine:!1}),s.jsx($,{contentStyle:q,formatter:e=>[t(e),"Spend"]}),s.jsx(D,{dataKey:"amount",fill:"#bf5af2",radius:[6,6,0,0]})]})})]})]}),c?.by_council&&c.by_council.length>0&&s.jsxs("section",{className:"supplier-section",children:[s.jsxs("h2",{children:[s.jsx(k,{size:22})," Council Breakdown"]}),s.jsx("div",{className:"supplier-table-wrapper",children:s.jsxs("table",{className:"supplier-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Council"}),s.jsx("th",{children:"Total Spend"}),s.jsx("th",{children:"Transactions"}),s.jsx("th",{children:"Years Active"})]})}),s.jsx("tbody",{children:c.by_council.map((e,i)=>s.jsxs("tr",{children:[s.jsx("td",{className:"council-name-cell",children:e.council.charAt(0).toUpperCase()+e.council.slice(1)}),s.jsx("td",{className:"amount-cell",children:t(e.total)}),s.jsx("td",{children:j(e.count)}),s.jsx("td",{className:"years-cell",children:e.years&&e.years.length>0?e.years.join(", "):"-"})]},i))})]})})]}),c?.by_department&&c.by_department.length>0&&s.jsxs("section",{className:"supplier-section",children:[s.jsxs("h2",{children:[s.jsx(W,{size:22})," Department Breakdown"]}),s.jsx("div",{className:"supplier-table-wrapper",children:s.jsxs("table",{className:"supplier-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Department"}),s.jsx("th",{children:"Total Spend"}),s.jsx("th",{children:"Transactions"})]})}),s.jsx("tbody",{children:c.by_department.map((e,i)=>s.jsxs("tr",{children:[s.jsx("td",{children:e.department}),s.jsx("td",{className:"amount-cell",children:t(e.total)}),s.jsx("td",{children:j(e.count)})]},i))})]})})]}),a&&s.jsxs("section",{className:"supplier-section",children:[s.jsxs("h2",{children:[s.jsx(G,{size:22})," Companies House"]}),s.jsx("div",{className:"ch-card",children:s.jsxs("div",{className:"ch-grid",children:[s.jsxs("div",{className:"ch-field",children:[s.jsx("span",{className:"ch-label",children:"Company Number"}),s.jsxs("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"ch-link",children:[a.company_number,s.jsx(Y,{size:14})]})]}),s.jsxs("div",{className:"ch-field",children:[s.jsx("span",{className:"ch-label",children:"Legal Name"}),s.jsx("span",{className:"ch-value",children:a.legal_name})]}),s.jsxs("div",{className:"ch-field",children:[s.jsx("span",{className:"ch-label",children:"Company Type"}),s.jsx("span",{className:"ch-value",children:a.company_type?.toUpperCase()||"-"})]}),s.jsxs("div",{className:"ch-field",children:[s.jsx("span",{className:"ch-label",children:"SIC Codes"}),s.jsx("span",{className:"ch-value",children:a.sic_codes&&a.sic_codes.length>0?a.sic_codes.join(", "):"-"})]}),s.jsxs("div",{className:"ch-field",children:[s.jsx("span",{className:"ch-label",children:"Incorporated"}),s.jsxs("span",{className:"ch-value",children:[s.jsx(v,{size:14}),h(a.incorporated)]})]}),a.dissolved&&s.jsxs("div",{className:"ch-field",children:[s.jsx("span",{className:"ch-label",children:"Dissolved"}),s.jsxs("span",{className:"ch-value ch-dissolved",children:[s.jsx(d,{size:14}),h(a.dissolved)]})]}),a.address&&s.jsxs("div",{className:"ch-field ch-field-wide",children:[s.jsx("span",{className:"ch-label",children:"Registered Address"}),s.jsxs("span",{className:"ch-value",children:[s.jsx(H,{size:14}),[a.address.address_line_1,a.address.locality,a.address.region,a.address.postal_code].filter(Boolean).join(", ")]})]})]})})]}),l&&s.jsxs("section",{className:"supplier-section",children:[s.jsxs("h2",{children:[s.jsx(g,{size:22})," Compliance"]}),s.jsxs("div",{className:"compliance-card",children:[s.jsxs("div",{className:"compliance-header",children:[s.jsxs("span",{className:"risk-badge-lg",style:{background:`${o}18`,color:o,borderColor:`${o}40`},children:[s.jsx(g,{size:18}),l.risk_level.charAt(0).toUpperCase()+l.risk_level.slice(1)," Risk"]}),l.violation_count>0&&s.jsxs("span",{className:"violation-count",children:[l.violation_count," violation",l.violation_count!==1?"s":""]})]}),s.jsxs("div",{className:"compliance-flags",children:[s.jsxs("div",{className:"compliance-flag",children:[s.jsx("span",{className:"flag-label",children:"Accounts Overdue"}),l.filing_status?.accounts_overdue?s.jsxs("span",{className:"flag-bad",children:[s.jsx(d,{size:16})," Yes"]}):s.jsxs("span",{className:"flag-good",children:[s.jsx(p,{size:16})," No"]})]}),s.jsxs("div",{className:"compliance-flag",children:[s.jsx("span",{className:"flag-label",children:"Confirmation Overdue"}),l.filing_status?.confirmation_overdue?s.jsxs("span",{className:"flag-bad",children:[s.jsx(d,{size:16})," Yes"]}):s.jsxs("span",{className:"flag-good",children:[s.jsx(p,{size:16})," No"]})]}),s.jsxs("div",{className:"compliance-flag",children:[s.jsx("span",{className:"flag-label",children:"Insolvency History"}),l.insolvency_history?s.jsxs("span",{className:"flag-bad",children:[s.jsx(d,{size:16})," Yes"]}):s.jsxs("span",{className:"flag-good",children:[s.jsx(p,{size:16})," No"]})]}),s.jsxs("div",{className:"compliance-flag",children:[s.jsx("span",{className:"flag-label",children:"Address Undeliverable"}),l.address_flags?.undeliverable?s.jsxs("span",{className:"flag-bad",children:[s.jsx(d,{size:16})," Yes"]}):s.jsxs("span",{className:"flag-good",children:[s.jsx(p,{size:16})," No"]})]}),s.jsxs("div",{className:"compliance-flag",children:[s.jsx("span",{className:"flag-label",children:"Address In Dispute"}),l.address_flags?.in_dispute?s.jsxs("span",{className:"flag-bad",children:[s.jsx(d,{size:16})," Yes"]}):s.jsxs("span",{className:"flag-good",children:[s.jsx(p,{size:16})," No"]})]})]}),l.violations&&l.violations.length>0&&s.jsxs("div",{className:"violations-list",children:[s.jsx("h3",{children:"Violations"}),l.violations.map((e,i)=>{const f=R[e.severity]||R.info;return s.jsxs("div",{className:"violation-item",children:[s.jsxs("div",{className:"violation-header",children:[s.jsx("span",{className:"severity-badge",style:{background:`${f}18`,color:f,borderColor:`${f}40`},children:e.severity.charAt(0).toUpperCase()+e.severity.slice(1)}),!e.current&&s.jsx("span",{className:"historical-badge",children:"Historical"}),e.law&&s.jsx("span",{className:"law-ref",children:e.law})]}),s.jsx("h4",{className:"violation-title",children:e.title}),s.jsx("p",{className:"violation-detail",children:e.detail}),(e.active_from||e.active_to)&&s.jsxs("div",{className:"violation-dates",children:[s.jsx(v,{size:14}),e.active_from&&s.jsxs("span",{children:["From: ",h(e.active_from)]}),e.active_to&&s.jsxs("span",{children:["To: ",h(e.active_to)]})]})]},i)})]})]})]}),n&&s.jsxs("section",{className:"supplier-section",children:[s.jsxs("h2",{children:[s.jsx(C,{size:22})," Governance"]}),s.jsxs("div",{className:"governance-card",children:[s.jsx("div",{className:"governance-summary",children:s.jsxs("span",{className:"governance-stat",children:[s.jsx(C,{size:18}),s.jsx("strong",{children:n.active_directors})," Active Director",n.active_directors!==1?"s":""]})}),n.directors&&n.directors.length>0&&s.jsxs("div",{className:"governance-subsection",children:[s.jsx("h3",{children:"Directors"}),s.jsx("div",{className:"directors-grid",children:n.directors.map((e,i)=>s.jsxs("div",{className:"director-card",children:[s.jsx("span",{className:"director-name",children:e.name}),s.jsx("span",{className:"director-role",children:e.role}),s.jsxs("span",{className:"director-appointed",children:[s.jsx(v,{size:12}),"Appointed ",h(e.appointed)]})]},i))})]}),n.pscs&&n.pscs.length>0&&s.jsxs("div",{className:"governance-subsection",children:[s.jsx("h3",{children:"Persons with Significant Control"}),s.jsx("div",{className:"pscs-list",children:n.pscs.map((e,i)=>s.jsxs("div",{className:"psc-item",children:[s.jsxs("div",{className:"psc-info",children:[s.jsx("span",{className:"psc-name",children:e.name}),s.jsx("span",{className:"psc-kind",children:e.kind.replace(/-/g," ")})]}),e.sanctioned&&s.jsxs("span",{className:"sanctioned-badge",children:[s.jsx(_,{size:14})," Sanctioned"]})]},i))})]})]})]}),s.jsxs("section",{className:"supplier-cta",children:[s.jsx("h3",{children:"Explore full transaction history"}),s.jsxs("p",{children:["View every payment made to ",r.name," in the spending explorer."]}),s.jsxs(x,{to:`/spending?supplier=${encodeURIComponent(r.canonical)}`,className:"cta-link",children:["View Transactions ",s.jsx(Y,{size:16})]})]})]})}export{ns as default};
