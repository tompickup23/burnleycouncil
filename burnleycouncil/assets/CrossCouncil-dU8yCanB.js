import{j as e}from"./tanstack-BHj98Y4o.js";import{r as L}from"./vendor-BUcjPAt-.js";import{u as D,a as E,L as z,B as O,d as o,P as T,h as C,U as M,g as $}from"./index-Pn4rdqlw.js";import{R as h,B as m,C as p,X as x,Y as j,T as v,a as f,f as K}from"./recharts-DyzHFDWD.js";import{C as B}from"./chart-column-pTiLU7iD.js";const d={burnley:"#0a84ff",hyndburn:"#ff9f0a",pendle:"#30d158"},y={background:"var(--card-bg, #1c1c1e)",border:"1px solid var(--border-color, #333)",borderRadius:"8px"};function Y(){const l=D(),r=l.council_name||"Council";l.council_id;const{data:c,loading:t}=E("/data/cross_council.json"),u=c;if(L.useEffect(()=>(document.title=`Cross-Council Comparison | ${r} Council Transparency`,()=>{document.title=`${r} Council Transparency`}),[r]),t)return e.jsx(z,{message:"Loading comparison data..."});if(!u?.councils?.length)return e.jsx("div",{className:"cross-page",children:e.jsx("p",{children:"No cross-council comparison data available."})});const n=u.councils;n.find(s=>s.council_name?.toLowerCase()===r.toLowerCase())||n[0];const _=n.map(s=>({name:s.council_name,spend:Math.round(s.total_spend/(s.population||1)),isCurrent:s.council_name===r})).sort((s,a)=>a.spend-s.spend),b=["housing","cultural","environmental","planning","central","other"],S={housing:"Housing",cultural:"Cultural",environmental:"Environmental",planning:"Planning",central:"Central",other:"Other"},k=b.map(s=>{const a={category:S[s]};return n.forEach(i=>{a[i.council_id]=Math.round((i.service_expenditure?.[s]||0)/(i.population||1))}),a});[{metric:"Dates",fullMark:100},{metric:"Suppliers",fullMark:100},{metric:"Departments",fullMark:100}].map(s=>(n.forEach(a=>{const i=a.transparency||{};s.metric==="Dates"&&(s[a.council_id]=i.has_dates||0),s.metric==="Suppliers"&&(s[a.council_id]=i.has_suppliers||0),s.metric==="Departments"&&(s[a.council_id]=i.has_departments||0)}),s));const w=n.filter(s=>s.pay?.ceo_midpoint).map(s=>({name:s.council_name,salary:s.pay.ceo_midpoint,ratio:s.pay.ceo_to_median_ratio,isCurrent:s.council_name===r})).sort((s,a)=>a.salary-s.salary),N=n.map(s=>({name:s.council_name,value:s.duplicate_value||0,count:s.duplicate_count||0,isCurrent:s.council_name===r})).sort((s,a)=>a.value-s.value);return e.jsxs("div",{className:"cross-page animate-fade-in",children:[e.jsx("header",{className:"cross-hero",children:e.jsxs("div",{className:"hero-content",children:[e.jsx("h1",{children:"Cross-Council Comparison"}),e.jsxs("p",{className:"hero-subtitle",children:["Side-by-side performance metrics for ",n.map(s=>s.council_name).join(", ")," councils.",r," is highlighted throughout."]})]})}),e.jsxs("section",{className:"cross-overview",children:[e.jsxs("h2",{children:[e.jsx(O,{size:22})," Council Overview"]}),e.jsx("div",{className:"overview-grid",children:n.map(s=>e.jsxs("div",{className:`overview-card ${s.council_name===r?"current":""}`,children:[e.jsxs("div",{className:"overview-header",style:{borderColor:d[s.council_id]},children:[e.jsx("h3",{children:s.council_name}),s.council_name===r&&e.jsx("span",{className:"current-badge",children:"You are here"})]}),e.jsxs("div",{className:"overview-stats",children:[e.jsxs("div",{className:"ov-stat",children:[e.jsx("span",{className:"ov-value",children:o(s.total_spend,!0)}),e.jsx("span",{className:"ov-label",children:"Total External Spend"})]}),e.jsxs("div",{className:"ov-stat",children:[e.jsx("span",{className:"ov-value",children:s.total_records?.toLocaleString()}),e.jsx("span",{className:"ov-label",children:"Transactions"})]}),e.jsxs("div",{className:"ov-stat",children:[e.jsx("span",{className:"ov-value",children:s.unique_suppliers?.toLocaleString()}),e.jsx("span",{className:"ov-label",children:"Unique Suppliers"})]}),e.jsxs("div",{className:"ov-stat",children:[e.jsx("span",{className:"ov-value",children:s.population?.toLocaleString()}),e.jsx("span",{className:"ov-label",children:"Population"})]})]})]},s.council_id))})]}),e.jsxs("section",{className:"cross-section",children:[e.jsxs("h2",{children:[e.jsx(T,{size:22})," Spend Per Head of Population"]}),e.jsx("p",{className:"section-intro",children:"Total external payments divided by population. Higher isn't necessarily worse — it depends on what services are provided."}),e.jsx("div",{className:"chart-container",children:e.jsx(h,{width:"100%",height:220,children:e.jsxs(m,{data:_,margin:{top:5,right:20,bottom:5,left:10},children:[e.jsx(p,{strokeDasharray:"3 3",stroke:"var(--border-color, #333)"}),e.jsx(x,{dataKey:"name",tick:{fill:"var(--text-secondary, #999)",fontSize:12}}),e.jsx(j,{tickFormatter:s=>`£${s.toLocaleString()}`,tick:{fill:"var(--text-secondary, #999)",fontSize:12}}),e.jsx(v,{formatter:s=>[`£${s.toLocaleString()}`,"Spend per head"],contentStyle:y}),e.jsx(f,{dataKey:"spend",radius:[4,4,0,0],children:_.map((s,a)=>e.jsx("rect",{fill:s.isCurrent?"#0a84ff":"#48484a"},a))})]})})})]}),e.jsxs("section",{className:"cross-section",children:[e.jsxs("h2",{children:[e.jsx(B,{size:22})," Service Expenditure Per Head (£'000s)"]}),e.jsx("p",{className:"section-intro",children:"GOV.UK revenue outturn data (2024-25) divided by population, showing how each council allocates spending across service categories."}),e.jsx("div",{className:"chart-container",children:e.jsx(h,{width:"100%",height:320,children:e.jsxs(m,{data:k,margin:{top:5,right:20,bottom:5,left:10},children:[e.jsx(p,{strokeDasharray:"3 3",stroke:"var(--border-color, #333)"}),e.jsx(x,{dataKey:"category",tick:{fill:"var(--text-secondary, #999)",fontSize:11}}),e.jsx(j,{tickFormatter:s=>`£${s}`,tick:{fill:"var(--text-secondary, #999)",fontSize:12}}),e.jsx(v,{formatter:(s,a)=>{const i=n.find(P=>P.council_id===a)?.council_name||a;return[`£${s.toLocaleString()}k per head`,i]},contentStyle:y}),e.jsx(K,{formatter:s=>n.find(a=>a.council_id===s)?.council_name||s}),n.map(s=>e.jsx(f,{dataKey:s.council_id,fill:d[s.council_id],radius:[2,2,0,0]},s.council_id))]})})})]}),e.jsxs("section",{className:"cross-section",children:[e.jsxs("h2",{children:[e.jsx(C,{size:22})," Transparency Scorecard"]}),e.jsx("p",{className:"section-intro",children:"Percentage of spending records that include key fields. 100% means every transaction has the field populated."}),e.jsx("div",{className:"scorecard-grid",children:n.map(s=>{const a=s.transparency||{};return e.jsxs("div",{className:`scorecard-card ${s.council_name===r?"current":""}`,children:[e.jsx("h3",{style:{color:d[s.council_id]},children:s.council_name}),e.jsxs("div",{className:"score-bars",children:[e.jsx(g,{label:"Dates",value:a.has_dates}),e.jsx(g,{label:"Suppliers",value:a.has_suppliers}),e.jsx(g,{label:"Departments",value:a.has_departments})]})]},s.council_id)})})]}),w.length>0&&e.jsxs("section",{className:"cross-section",children:[e.jsxs("h2",{children:[e.jsx(M,{size:22})," Chief Executive Pay"]}),e.jsx("p",{className:"section-intro",children:"CEO salary midpoints and pay ratios from published Pay Policy Statements."}),e.jsx("div",{className:"comparison-table-wrapper",children:e.jsxs("table",{className:"cross-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Council"}),e.jsx("th",{children:"CEO Salary Midpoint"}),e.jsx("th",{children:"CEO:Median Ratio"}),e.jsx("th",{children:"Median Employee Pay"})]})}),e.jsx("tbody",{children:n.filter(s=>s.pay).map(s=>e.jsxs("tr",{className:s.council_name===r?"highlight-row":"",children:[e.jsxs("td",{className:"council-name",children:[s.council_name,s.council_name===r?" ★":""]}),e.jsx("td",{children:o(s.pay.ceo_midpoint)}),e.jsx("td",{children:s.pay.ceo_to_median_ratio?`${s.pay.ceo_to_median_ratio}:1`:"—"}),e.jsx("td",{children:s.pay.median_employee_salary?o(s.pay.median_employee_salary):"—"})]},s.council_id))})]})})]}),e.jsxs("section",{className:"cross-section",children:[e.jsxs("h2",{children:[e.jsx($,{size:22})," Potential Duplicate Payments"]}),e.jsx("p",{className:"section-intro",children:"Same-day payments to the same supplier for the same amount. These are flagged for investigation — not all are errors."}),e.jsx("div",{className:"chart-container",children:e.jsx(h,{width:"100%",height:220,children:e.jsxs(m,{data:N,margin:{top:5,right:20,bottom:5,left:10},children:[e.jsx(p,{strokeDasharray:"3 3",stroke:"var(--border-color, #333)"}),e.jsx(x,{dataKey:"name",tick:{fill:"var(--text-secondary, #999)",fontSize:12}}),e.jsx(j,{tickFormatter:s=>`£${(s/1e6).toFixed(1)}M`,tick:{fill:"var(--text-secondary, #999)",fontSize:12}}),e.jsx(v,{formatter:s=>[o(s),"Flagged value"],contentStyle:y}),e.jsx(f,{dataKey:"value",radius:[4,4,0,0],children:N.map((s,a)=>e.jsx("rect",{fill:s.isCurrent?"#ff453a":"#48484a"},a))})]})})}),e.jsx("div",{className:"dupe-stats",children:n.map(s=>e.jsxs("div",{className:"dupe-stat",children:[e.jsx("span",{className:"dupe-council",style:{color:d[s.council_id]},children:s.council_name}),e.jsxs("span",{className:"dupe-count",children:[(s.duplicate_count||0).toLocaleString()," flagged transactions"]}),e.jsxs("span",{className:"dupe-value",children:[o(s.duplicate_value||0)," total value"]})]},s.council_id))})]}),e.jsx("section",{className:"cross-section",children:e.jsxs("div",{className:"methodology-note",children:[e.jsx(C,{size:18}),e.jsxs("div",{children:[e.jsx("h4",{children:"Methodology"}),e.jsxs("p",{children:["All data is sourced from publicly available council documents including transparency returns, GOV.UK revenue outturn data, and Pay Policy Statements. Spending figures cover external payments over £500 from ",n[0]?.financial_years?.[0]||"2021/22"," to ",n[0]?.financial_years?.slice(-1)[0]||"2025/26",". Population figures from ONS mid-year estimates."]}),e.jsxs("p",{className:"generated-date",children:["Comparison generated: ",u.generated]})]})]})})]})}function g({label:l,value:r}){const c=Math.round(r||0);let t="#30d158";return c<80&&(t="#ff9f0a"),c<50&&(t="#ff453a"),e.jsxs("div",{className:"score-bar-row",children:[e.jsx("span",{className:"score-label",children:l}),e.jsx("div",{className:"score-track",children:e.jsx("div",{className:"score-fill",style:{width:`${c}%`,background:t}})}),e.jsxs("span",{className:"score-pct",style:{color:t},children:[c,"%"]})]})}export{Y as default};
