<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode | default "en-GB" }}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme-color" content="#0a0a0a">
  <meta name="color-scheme" content="dark">

  {{/* Preconnect to external domains */}}
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  {{/* Critical CSS inline */}}
  <style>
    {{ $critical := resources.Get "css/critical.css" | resources.Minify }}
    {{ $critical.Content | safeCSS }}
  </style>

  {{/* Preload main CSS */}}
  {{ $mainCSS := resources.Get "css/main.css" | resources.Minify | resources.Fingerprint }}
  <link rel="preload" href="{{ $mainCSS.RelPermalink }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="{{ $mainCSS.RelPermalink }}"></noscript>

  {{/* Favicon */}}
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ“°</text></svg>">

  {{/* Title */}}
  <title>{{ if .IsHome }}{{ .Site.Title }} - Lancashire News & AI Digest{{ else }}{{ .Title }} | {{ .Site.Title }}{{ end }}</title>

  {{/* Meta Description */}}
  <meta name="description" content="{{ if .Description }}{{ .Description }}{{ else if .Summary }}{{ .Summary | plainify | truncate 160 }}{{ else }}{{ .Site.Params.description }}{{ end }}">
  <meta name="author" content="{{ .Site.Title }}">
  <meta name="robots" content="index, follow">
  <meta name="generator" content="Hugo {{ hugo.Version }}">

  {{/* Canonical URL */}}
  <link rel="canonical" href="{{ .Permalink }}">

  {{/* Open Graph / Facebook */}}
  <meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
  <meta property="og:url" content="{{ .Permalink }}">
  <meta property="og:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }}{{ end }}">
  <meta property="og:description" content="{{ if .Description }}{{ .Description }}{{ else if .Summary }}{{ .Summary | plainify | truncate 200 }}{{ else }}{{ .Site.Params.description }}{{ end }}">
  <meta property="og:site_name" content="{{ .Site.Title }}">
  <meta property="og:locale" content="en_GB">
  {{ if .Params.image }}<meta property="og:image" content="{{ .Params.image | absURL }}">{{ end }}

  {{/* Twitter Card */}}
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="{{ .Permalink }}">
  <meta name="twitter:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }}{{ end }}">
  <meta name="twitter:description" content="{{ if .Description }}{{ .Description }}{{ else if .Summary }}{{ .Summary | plainify | truncate 200 }}{{ else }}{{ .Site.Params.description }}{{ end }}">
  {{ if .Params.image }}<meta name="twitter:image" content="{{ .Params.image | absURL }}">{{ end }}

  {{/* Schema.org - NewsArticle for article pages */}}
  {{ if .IsPage }}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "NewsArticle",
    "headline": "{{ .Title }}",
    "description": "{{ if .Description }}{{ .Description }}{{ else if .Summary }}{{ .Summary | plainify | truncate 200 }}{{ end }}",
    "url": "{{ .Permalink }}",
    "datePublished": "{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}",
    "dateModified": "{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}",
    "author": {
      "@type": "Organization",
      "name": "{{ .Site.Title }}"
    },
    "publisher": {
      "@type": "Organization",
      "name": "{{ .Site.Title }}",
      "url": "{{ .Site.BaseURL }}",
      "logo": {
        "@type": "ImageObject",
        "url": "{{ "/images/logo.png" | absURL }}"
      }
    }{{ if .Params.image }},
    "image": {
      "@type": "ImageObject",
      "url": "{{ .Params.image | absURL }}"
    }{{ end }}{{ if .Params.tags }},
    "keywords": "{{ delimit .Params.tags ", " }}"{{ end }}
  }
  </script>
  {{ end }}

  {{/* Schema.org - Organization for homepage */}}
  {{ if .IsHome }}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "{{ .Site.Title }}",
    "url": "{{ .Site.BaseURL }}",
    "description": "{{ .Site.Params.description }}",
    "sameAs": [
      "https://twitter.com/newslancashire"
    ]
  }
  </script>
  {{ end }}

  {{/* Schema.org - BreadcrumbList */}}
  {{ if not .IsHome }}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "{{ .Site.BaseURL }}"
      }{{ if .Parent }},
      {
        "@type": "ListItem",
        "position": 2,
        "name": "{{ .Parent.Title }}",
        "item": "{{ .Parent.Permalink }}"
      },
      {
        "@type": "ListItem",
        "position": 3,
        "name": "{{ .Title }}",
        "item": "{{ .Permalink }}"
      }{{ else }},
      {
        "@type": "ListItem",
        "position": 2,
        "name": "{{ .Title }}",
        "item": "{{ .Permalink }}"
      }{{ end }}
    ]
  }
  </script>
  {{ end }}

  {{/* RSS Feed */}}
  {{ range .AlternativeOutputFormats }}
  <link rel="{{ .Rel }}" type="{{ .MediaType.Type }}" href="{{ .Permalink }}" title="{{ $.Site.Title }}">
  {{ end }}

  {{ block "head" . }}{{ end }}
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to main content</a>

  {{ partial "header.html" . }}

  <main id="main-content">
    {{ block "main" . }}{{ end }}
  </main>

  {{ partial "footer.html" . }}

  {{/* Main JavaScript - deferred */}}
  {{ $mainJS := resources.Get "js/main.js" | resources.Minify | resources.Fingerprint }}
  <script src="{{ $mainJS.RelPermalink }}" defer></script>

  {{ block "scripts" . }}{{ end }}
</body>
</html>
