import{j as e}from"./tanstack-BHj98Y4o.js";import{r as o,i as je}from"./vendor-BUcjPAt-.js";import{c as Q,b as fe,u as ve,t as F,L as ge,S as ye,X as le,d as m,T as be,f as Ne}from"./index-rU4F0J3P.js";import{C as ne,a as Ce}from"./chevron-up-BqJhKtQ0.js";import{F as _e}from"./funnel-C-YHAbF0.js";import{C as Se,B as ke}from"./chart-column-DzTg7QY2.js";import{R as K,A as we,C as J,X as Z,Y as ee,T as I,d as ie,B as ce,a as oe,c as ae,P as De,b as Le}from"./recharts-OQS_r4Wn.js";const Te=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Me=Q("activity",Te);const $e=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],Ae=Q("arrow-down-right",$e);const Ee=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],Fe=Q("arrow-up-right",Ee);const Oe=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Re=Q("download",Oe);function A({label:y,value:b,options:E,onChange:q,placeholder:D}){const[p,x]=o.useState(!1),[R,_]=o.useState(""),z=o.useRef(null),S=o.useRef(null),N=E.filter(r=>r.toLowerCase().includes(R.toLowerCase())),T=b||D;o.useEffect(()=>{if(!p)return;const r=M=>{z.current&&!z.current.contains(M.target)&&(x(!1),_(""))};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[p]),o.useEffect(()=>{p&&S.current&&S.current.focus()},[p]);const C=r=>{r.key==="Escape"?(x(!1),_("")):r.key==="Enter"&&!p&&x(!0)};return e.jsxs("div",{className:"searchable-select",ref:z,onKeyDown:C,children:[y&&e.jsx("label",{children:y}),e.jsxs("div",{className:"select-container",children:[e.jsxs("button",{type:"button",className:"select-trigger",onClick:()=>x(!p),"aria-haspopup":"listbox","aria-expanded":p,children:[e.jsx("span",{className:b?"":"placeholder",children:T}),e.jsx(ne,{size:16,className:`select-chevron ${p?"open":""}`})]}),p&&e.jsxs("div",{className:"select-dropdown",role:"listbox",children:[e.jsx("input",{ref:S,type:"text",className:"select-search",placeholder:"Search...",value:R,onChange:r=>_(r.target.value),"aria-label":`Search ${y||"options"}`}),e.jsxs("div",{className:"select-options",children:[e.jsx("div",{role:"option","aria-selected":!b,className:`select-option ${b?"":"selected"}`,onClick:()=>{q(""),x(!1),_("")},children:D}),N.map(r=>e.jsx("div",{role:"option","aria-selected":b===r,className:`select-option ${b===r?"selected":""}`,onClick:()=>{q(r),x(!1),_("")},children:r},r)),N.length===0&&e.jsx("div",{className:"select-no-results",children:"No matches"})]})]})]})]})}const se=50,O=["#0a84ff","#30d158","#ff9f0a","#ff453a","#bf5af2","#64d2ff","#ff375f","#ffd60a","#ac8e68","#8e8e93"],V={background:"rgba(28, 28, 30, 0.95)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"10px",boxShadow:"0 8px 32px rgba(0,0,0,0.4)",padding:"12px 16px"},ze={spend:"Spend",contracts:"Contracts",purchase_cards:"Purchase Cards"},G=y=>ze[y]||y,Pe=["financial_year","quarter","month","type","service_division","expenditure_category","capital_revenue","supplier","min_amount","max_amount"];function te({field:y,sortField:b,sortDir:E}){return b!==y?e.jsx(ne,{size:14,className:"sort-inactive"}):E==="asc"?e.jsx(Ce,{size:14}):e.jsx(ne,{size:14})}function Qe(){const y=fe(),b=y.council_name||"Council",{data:E,loading:q}=ve("/data/spending.json"),[D,p]=je(),[x,R]=o.useState("table"),[_,z]=o.useState(!0),S=D.get("q")||"",N=D.get("sort")||"date",T=D.get("dir")||"desc",C=parseInt(D.get("page")||"1",10),r=o.useMemo(()=>{const a={};return Pe.forEach(s=>{a[s]=D.get(s)||""}),a},[D]),M=o.useCallback((a,s)=>{p(n=>{const i=new URLSearchParams(n);return s?i.set(a,s):i.delete(a),a!=="page"&&i.delete("page"),i},{replace:!0})},[p]),re=o.useCallback(a=>M("q",a),[M]),B=o.useCallback(a=>M("page",a>1?String(a):""),[M]),k=o.useCallback((a,s)=>M(a,s),[M]),H=o.useCallback(a=>{p(s=>{const n=new URLSearchParams(s);return n.get("sort")===a?n.set("dir",n.get("dir")==="asc"?"desc":"asc"):(n.set("sort",a),n.set("dir","desc")),n.delete("page"),n},{replace:!0})},[p]),de=o.useCallback(()=>{p({},{replace:!0})},[p]);o.useEffect(()=>(document.title=`Spending Explorer | ${b} Council Transparency`,()=>{document.title=`${b} Council Transparency | Where Your Money Goes`}),[]);const W=Object.values(r).filter(Boolean).length+(S?1:0),v=o.useMemo(()=>E||[],[E]),$=o.useMemo(()=>{if(!v.length)return{};const a=n=>[...new Set(n.filter(Boolean))].sort(),s=v.map(n=>n.date?new Date(n.date).toLocaleString("en-GB",{month:"long",year:"numeric"}):null);return{financial_years:a(v.map(n=>n.financial_year)),quarters:["Q1","Q2","Q3","Q4"],months:a(s),types:a(v.map(n=>n.type)),service_divisions:a(v.map(n=>n.service_division)),expenditure_categories:a(v.map(n=>n.expenditure_category)),capital_revenue:a(v.map(n=>n.capital_revenue)),suppliers:a(v.map(n=>n.supplier))}},[v]),h=o.useMemo(()=>{let a=v;if(S){const s=S.toLowerCase();a=a.filter(n=>n.supplier?.toLowerCase().includes(s)||n.organisational_unit?.toLowerCase().includes(s)||n.service_division?.toLowerCase().includes(s)||n.expenditure_category?.toLowerCase().includes(s)||n.transaction_number?.toLowerCase().includes(s))}if(r.financial_year&&(a=a.filter(s=>s.financial_year===r.financial_year)),r.quarter){const s=parseInt(r.quarter.replace("Q",""));a=a.filter(n=>n.quarter===s)}return r.month&&(a=a.filter(s=>s.date?new Date(s.date).toLocaleString("en-GB",{month:"long",year:"numeric"})===r.month:!1)),r.type&&(a=a.filter(s=>s.type===r.type)),r.service_division&&(a=a.filter(s=>s.service_division===r.service_division)),r.expenditure_category&&(a=a.filter(s=>s.expenditure_category===r.expenditure_category)),r.capital_revenue&&(a=a.filter(s=>s.capital_revenue===r.capital_revenue)),r.supplier&&(a=a.filter(s=>s.supplier===r.supplier)),r.min_amount&&(a=a.filter(s=>(s.amount||0)>=parseFloat(r.min_amount))),r.max_amount&&(a=a.filter(s=>(s.amount||0)<=parseFloat(r.max_amount))),a=[...a].sort((s,n)=>{let i=s[N],j=n[N];return N==="amount"?(i=Number(i)||0,j=Number(j)||0):N==="date"&&(i=new Date(i||"1970-01-01").getTime(),j=new Date(j||"1970-01-01").getTime()),i<j?T==="asc"?-1:1:i>j?T==="asc"?1:-1:0}),a},[v,S,r,N,T]),he=o.useMemo(()=>{const a=(C-1)*se;return h.slice(a,a+se)},[h,C]),P=Math.ceil(h.length/se),w=o.useMemo(()=>{const a=h.reduce((c,u)=>c+(Number(u.amount)||0),0),s=new Set(h.map(c=>c.supplier)).size,n=h.length>0?a/h.length:0,i=(()=>{if(!h.length)return 0;const c=h.map(U=>Number(U.amount)||0).sort((U,Y)=>U-Y),u=Math.floor(c.length/2);return c.length%2?c[u]:(c[u-1]+c[u])/2})(),j=h.reduce((c,u)=>Math.max(c,Number(u.amount)||0),0),L={};return h.forEach(c=>{const u=c.type||"other";L[u]=(L[u]||0)+(Number(c.amount)||0)}),{total:a,count:h.length,suppliers:s,avgTransaction:n,medianAmount:i,maxTransaction:j,byType:L}},[h]),d=o.useMemo(()=>{const a=t=>{const l={};return h.forEach(f=>{const g=t(f);g&&(l[g]=(l[g]||0)+(f.amount||0))}),l},s=t=>{const l={};return h.forEach(f=>{const g=t(f);g&&(l[g]=(l[g]||0)+1)}),l},n=a(t=>t.financial_year||"Unknown"),i=s(t=>t.financial_year||"Unknown"),j=a(t=>t.expenditure_category||"Other"),L=a(t=>t.service_division||"Other"),c=a(t=>t.supplier||"Unknown"),u=s(t=>t.supplier||"Unknown"),U=a(t=>t.type||"other"),Y={},X={};h.forEach(t=>{if(!t.date)return;const l=new Date(t.date),f=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;Y[f]=(Y[f]||0)+(t.amount||0),X[f]=(X[f]||0)+1});const ue=Object.entries(Y).map(([t,l])=>({month:t,amount:l,count:X[t]||0,label:(()=>{const[f,g]=t.split("-");return new Date(f,g-1).toLocaleString("en-GB",{month:"short",year:"2-digit"})})()})).sort((t,l)=>t.month.localeCompare(l.month)).slice(-36).map((t,l,f)=>{const g=f.slice(Math.max(0,l-2),l+1);return{...t,avg:g.reduce((me,xe)=>me+xe.amount,0)/g.length}});return{yearData:Object.entries(n).map(([t,l])=>({year:t,amount:l,count:i[t]||0,avg:(i[t]||1)>0?l/i[t]:0})).sort((t,l)=>t.year.localeCompare(l.year)),categoryData:Object.entries(j).map(([t,l])=>({name:t,value:l})).sort((t,l)=>l.value-t.value).slice(0,10),serviceData:Object.entries(L).map(([t,l])=>({name:t.split(" - ")[1]||t,fullName:t,value:l})).sort((t,l)=>l.value-t.value).slice(0,10),supplierData:Object.entries(c).map(([t,l])=>({name:F(t,25),fullName:t,value:l,count:u[t]||0})).sort((t,l)=>l.value-t.value).slice(0,10),typeData:Object.entries(U).map(([t,l])=>({name:G(t),value:l,rawType:t})).sort((t,l)=>l.value-t.value),monthlyData:ue}},[h]),pe=()=>{const a=["Date","Supplier","Amount","Type","Service","Category","Org Unit","Transaction"],s=h.map(c=>[c.date,c.supplier,c.amount,c.type,c.service_division,c.expenditure_category,c.organisational_unit,c.transaction_number]),n=[a,...s].map(c=>c.map(u=>`"${u||""}"`).join(",")).join(`
`),i=new Blob([n],{type:"text/csv"}),j=URL.createObjectURL(i),L=document.createElement("a");L.href=j,L.download=`${y.council_id||"council"}-spending-export-${new Date().toISOString().split("T")[0]}.csv`,L.click(),URL.revokeObjectURL(j)};return q?e.jsx(ge,{message:"Loading spending data..."}):e.jsxs("div",{className:"spending-page animate-fade-in",children:[e.jsxs("header",{className:"page-header",children:[e.jsxs("div",{className:"header-content",children:[e.jsx("h1",{children:"Spending Explorer"}),e.jsxs("p",{className:"subtitle",children:["Search and analyse ",v.length.toLocaleString()," council transactions"]})]}),e.jsx("div",{className:"header-actions",children:e.jsxs("button",{className:"export-btn",onClick:pe,children:[e.jsx(Re,{size:18}),"Export CSV"]})})]}),e.jsxs("div",{className:"search-section",children:[e.jsxs("div",{className:"search-bar",children:[e.jsx(ye,{size:20,className:"search-icon"}),e.jsx("input",{type:"text",placeholder:"Search suppliers, services, transaction numbers...",value:S,onChange:a=>re(a.target.value),"aria-label":"Search spending records"}),S&&e.jsx("button",{className:"search-clear",onClick:()=>re(""),"aria-label":"Clear search",children:e.jsx(le,{size:16})})]}),e.jsxs("button",{className:`filter-toggle ${_?"active":""}`,onClick:()=>z(!_),"aria-expanded":_,children:[e.jsx(_e,{size:18}),"Filters",W>0&&e.jsx("span",{className:"filter-count",children:W})]})]}),_&&e.jsxs("div",{className:"filter-panel",children:[e.jsxs("div",{className:"filter-grid",children:[e.jsx(A,{label:"Financial Year",value:r.financial_year,options:$.financial_years||[],onChange:a=>k("financial_year",a),placeholder:"All Years"}),e.jsx(A,{label:"Quarter",value:r.quarter,options:$.quarters||[],onChange:a=>k("quarter",a),placeholder:"All Quarters"}),e.jsx(A,{label:"Month",value:r.month,options:$.months||[],onChange:a=>k("month",a),placeholder:"All Months"}),e.jsx(A,{label:"Data Type",value:r.type,options:$.types||[],onChange:a=>k("type",a),placeholder:"All Types"}),e.jsx(A,{label:"Service Division",value:r.service_division,options:$.service_divisions||[],onChange:a=>k("service_division",a),placeholder:"All Services"}),e.jsx(A,{label:"Expenditure Category",value:r.expenditure_category,options:$.expenditure_categories||[],onChange:a=>k("expenditure_category",a),placeholder:"All Categories"}),e.jsx(A,{label:"Capital/Revenue",value:r.capital_revenue,options:$.capital_revenue||[],onChange:a=>k("capital_revenue",a),placeholder:"All"}),e.jsx(A,{label:"Supplier",value:r.supplier,options:$.suppliers||[],onChange:a=>k("supplier",a),placeholder:"All Suppliers"}),e.jsxs("div",{className:"filter-group amount-filter",children:[e.jsx("label",{children:"Amount Range"}),e.jsxs("div",{className:"amount-inputs",children:[e.jsx("input",{type:"number",placeholder:"Min £",value:r.min_amount,onChange:a=>k("min_amount",a.target.value),"aria-label":"Minimum amount"}),e.jsx("span",{children:"to"}),e.jsx("input",{type:"number",placeholder:"Max £",value:r.max_amount,onChange:a=>k("max_amount",a.target.value),"aria-label":"Maximum amount"})]})]})]}),W>0&&e.jsxs("button",{className:"clear-filters",onClick:de,children:[e.jsx(le,{size:16}),"Clear all filters"]})]}),e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card stat-primary",children:[e.jsx("div",{className:"stat-card-icon",children:e.jsx(Me,{size:20})}),e.jsxs("div",{className:"stat-card-body",children:[e.jsx("span",{className:"stat-card-value",children:m(w.total,!0)}),e.jsx("span",{className:"stat-card-label",children:"Total Spend"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-card-icon",children:e.jsx(Se,{size:20})}),e.jsxs("div",{className:"stat-card-body",children:[e.jsx("span",{className:"stat-card-value",children:w.count.toLocaleString()}),e.jsx("span",{className:"stat-card-label",children:"Transactions"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-card-icon",children:e.jsx(ke,{size:20})}),e.jsxs("div",{className:"stat-card-body",children:[e.jsx("span",{className:"stat-card-value",children:w.suppliers.toLocaleString()}),e.jsx("span",{className:"stat-card-label",children:"Suppliers"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-card-icon",children:e.jsx(be,{size:20})}),e.jsxs("div",{className:"stat-card-body",children:[e.jsx("span",{className:"stat-card-value",children:m(w.avgTransaction,!0)}),e.jsx("span",{className:"stat-card-label",children:"Average"}),e.jsxs("span",{className:"stat-card-sub",children:["Median: ",m(w.medianAmount,!0)]})]})]}),Object.keys(w.byType).length>0&&e.jsxs("div",{className:"stat-card stat-wide type-breakdown-card",children:[e.jsx("div",{className:"type-breakdown-bar",children:Object.entries(w.byType).sort((a,s)=>s[1]-a[1]).map(([a,s])=>e.jsx("div",{className:`type-segment ${a}`,style:{flex:s},title:`${G(a)}: ${m(s,!0)}`},a))}),e.jsx("div",{className:"type-breakdown-legend",children:Object.entries(w.byType).sort((a,s)=>s[1]-a[1]).map(([a,s])=>e.jsxs("span",{className:"type-legend-item",children:[e.jsx("span",{className:`type-dot ${a}`}),G(a),": ",m(s,!0),e.jsxs("span",{className:"type-pct",children:["(",w.total>0?(s/w.total*100).toFixed(1):0,"%)"]})]},a))})]})]}),e.jsxs("div",{className:"tab-nav",role:"tablist",children:[e.jsx("button",{role:"tab","aria-selected":x==="table",className:`tab-btn ${x==="table"?"active":""}`,onClick:()=>R("table"),children:"Data Table"}),e.jsx("button",{role:"tab","aria-selected":x==="charts",className:`tab-btn ${x==="charts"?"active":""}`,onClick:()=>R("charts"),children:"Visualisations"})]}),x==="table"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"spending-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{className:"sortable",onClick:()=>H("date"),children:["Date ",e.jsx(te,{field:"date",sortField:N,sortDir:T})]}),e.jsxs("th",{className:"sortable",onClick:()=>H("supplier"),children:["Supplier ",e.jsx(te,{field:"supplier",sortField:N,sortDir:T})]}),e.jsx("th",{children:"Service"}),e.jsx("th",{children:"Category"}),e.jsxs("th",{className:"sortable amount-col",onClick:()=>H("amount"),children:["Amount ",e.jsx(te,{field:"amount",sortField:N,sortDir:T})]}),e.jsx("th",{children:"Type"})]})}),e.jsx("tbody",{children:he.map((a,s)=>e.jsxs("tr",{children:[e.jsx("td",{className:"date-col",children:Ne(a.date)}),e.jsxs("td",{className:"supplier-col",children:[e.jsx("span",{className:"supplier-name",children:F(a.supplier,35)}),a.is_covid_related&&e.jsx("span",{className:"covid-badge",children:"COVID"})]}),e.jsx("td",{className:"service-col text-secondary",children:F(a.service_division?.split(" - ")[1]||a.service_division,20)}),e.jsx("td",{className:"category-col text-secondary",children:F(a.expenditure_category,25)}),e.jsx("td",{className:"amount-col",children:m(a.amount)}),e.jsx("td",{className:"type-col",children:e.jsx("span",{className:`type-badge ${a.type}`,children:G(a.type)})})]},`${a.transaction_number}-${s}`))})]})}),P>1&&e.jsxs("div",{className:"pagination",children:[e.jsx("button",{className:"page-btn",disabled:C===1,onClick:()=>B(1),children:"First"}),e.jsx("button",{className:"page-btn",disabled:C===1,onClick:()=>B(C-1),children:"Previous"}),e.jsxs("span",{className:"page-info",children:["Page ",C," of ",P]}),e.jsx("button",{className:"page-btn",disabled:C===P,onClick:()=>B(C+1),children:"Next"}),e.jsx("button",{className:"page-btn",disabled:C===P,onClick:()=>B(P),children:"Last"})]})]}),x==="charts"&&e.jsxs("div",{className:"charts-grid",children:[e.jsxs("div",{className:"chart-card wide hero-chart",children:[e.jsxs("div",{className:"chart-header",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Monthly Spending Trend"}),e.jsxs("p",{className:"chart-subtitle",children:["Last ",d.monthlyData.length," months with 3-month rolling average"]})]}),d.monthlyData.length>=2&&(()=>{const a=d.monthlyData[d.monthlyData.length-1]?.amount||0,s=d.monthlyData[d.monthlyData.length-2]?.amount||0,n=s>0?(a-s)/s*100:0,i=n>=0;return e.jsxs("div",{className:`chart-trend ${i?"up":"down"}`,children:[i?e.jsx(Fe,{size:16}):e.jsx(Ae,{size:16}),e.jsxs("span",{children:[Math.abs(n).toFixed(1),"%"]}),e.jsx("span",{className:"chart-trend-label",children:"vs prior month"})]})})()]}),e.jsx(K,{width:"100%",height:320,children:e.jsxs(we,{data:d.monthlyData,margin:{top:10,right:30,left:20,bottom:5},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"spendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#0a84ff",stopOpacity:.3}),e.jsx("stop",{offset:"100%",stopColor:"#0a84ff",stopOpacity:0})]})}),e.jsx(J,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.04)"}),e.jsx(Z,{dataKey:"label",tick:{fill:"var(--text-tertiary)",fontSize:11},interval:2,axisLine:!1,tickLine:!1}),e.jsx(ee,{tick:{fill:"var(--text-tertiary)",fontSize:11},tickFormatter:a=>`£${(a/1e6).toFixed(1)}M`,axisLine:!1,tickLine:!1}),e.jsx(I,{contentStyle:V,formatter:(a,s)=>[m(a,!0),s==="avg"?"3-Mo Average":"Monthly Spend"],labelFormatter:a=>a}),e.jsx(ie,{type:"monotone",dataKey:"amount",stroke:"#0a84ff",strokeWidth:2,fill:"url(#spendGradient)"}),e.jsx(ie,{type:"monotone",dataKey:"avg",stroke:"#ff9f0a",strokeWidth:2,strokeDasharray:"6 3",fill:"none"})]})})]}),e.jsxs("div",{className:"chart-card",children:[e.jsx("div",{className:"chart-header",children:e.jsx("h3",{children:"Spend by Financial Year"})}),e.jsx(K,{width:"100%",height:300,children:e.jsxs(ce,{data:d.yearData,margin:{top:20,right:30,left:10,bottom:5},children:[e.jsx(J,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.04)"}),e.jsx(Z,{dataKey:"year",tick:{fill:"var(--text-tertiary)",fontSize:11},axisLine:!1,tickLine:!1}),e.jsx(ee,{tick:{fill:"var(--text-tertiary)",fontSize:11},tickFormatter:a=>`£${(a/1e6).toFixed(0)}M`,axisLine:!1,tickLine:!1}),e.jsx(I,{contentStyle:V,formatter:a=>[m(a,!0),"Total"],labelFormatter:a=>`FY ${a}`}),e.jsx(oe,{dataKey:"amount",radius:[6,6,0,0],children:d.yearData.map((a,s)=>e.jsx(ae,{fill:s===d.yearData.length-1?"#0a84ff":"rgba(10, 132, 255, 0.35)"},s))})]})}),e.jsx("div",{className:"chart-year-footer",children:d.yearData.slice(-3).map(a=>e.jsxs("div",{className:"year-stat",children:[e.jsx("span",{className:"year-stat-label",children:a.year}),e.jsx("span",{className:"year-stat-value",children:m(a.amount,!0)}),e.jsxs("span",{className:"year-stat-sub",children:[a.count.toLocaleString()," txns"]})]},a.year))})]}),e.jsxs("div",{className:"chart-card",children:[e.jsx("div",{className:"chart-header",children:e.jsx("h3",{children:"Spending by Type"})}),e.jsx(K,{width:"100%",height:280,children:e.jsxs(De,{children:[e.jsx(Le,{data:d.typeData,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:3,strokeWidth:0,children:d.typeData.map(a=>e.jsx(ae,{fill:a.rawType==="spend"?"#0a84ff":a.rawType==="contracts"?"#bf5af2":"#30d158"},a.rawType))}),e.jsx(I,{contentStyle:V,formatter:a=>[m(a,!0),"Total"]})]})}),e.jsx("div",{className:"donut-legend",children:d.typeData.map(a=>e.jsxs("div",{className:"donut-legend-item",children:[e.jsx("span",{className:`type-dot ${a.rawType}`}),e.jsx("span",{className:"donut-legend-name",children:a.name}),e.jsx("span",{className:"donut-legend-value",children:m(a.value,!0)})]},a.rawType))})]}),e.jsxs("div",{className:"chart-card wide",children:[e.jsxs("div",{className:"chart-header",children:[e.jsx("h3",{children:"Top 10 Suppliers by Value"}),e.jsx("p",{className:"chart-subtitle",children:"Hover for transaction count"})]}),e.jsx(K,{width:"100%",height:380,children:e.jsxs(ce,{data:d.supplierData,layout:"vertical",margin:{top:10,right:40,left:130,bottom:5},children:[e.jsx(J,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.04)",horizontal:!1}),e.jsx(Z,{type:"number",tick:{fill:"var(--text-tertiary)",fontSize:11},tickFormatter:a=>`£${(a/1e6).toFixed(1)}M`,axisLine:!1,tickLine:!1}),e.jsx(ee,{type:"category",dataKey:"name",tick:{fill:"var(--text-secondary)",fontSize:11},width:120,axisLine:!1,tickLine:!1}),e.jsx(I,{contentStyle:V,formatter:(a,s,n)=>{const i=n.payload;return[`${m(a,!0)} (${i.count} transactions)`,i.fullName]}}),e.jsx(oe,{dataKey:"value",radius:[0,6,6,0],children:d.supplierData.map((a,s)=>e.jsx(ae,{fill:O[s%O.length],fillOpacity:.85},s))})]})})]}),e.jsxs("div",{className:"chart-card",children:[e.jsx("div",{className:"chart-header",children:e.jsx("h3",{children:"Top Expenditure Categories"})}),e.jsx("div",{className:"inline-bar-list",children:d.categoryData.slice(0,8).map((a,s)=>{const n=d.categoryData[0]?.value||1,i=a.value/n*100;return e.jsxs("div",{className:"inline-bar-item",children:[e.jsx("span",{className:"inline-bar-label",title:a.name,children:F(a.name,22)}),e.jsx("div",{className:"inline-bar-track",children:e.jsx("div",{className:"inline-bar-fill",style:{width:`${i}%`,background:O[s%O.length]}})}),e.jsx("span",{className:"inline-bar-value",children:m(a.value,!0)})]},a.name)})})]}),e.jsxs("div",{className:"chart-card",children:[e.jsx("div",{className:"chart-header",children:e.jsx("h3",{children:"Spending by Service Division"})}),e.jsx("div",{className:"inline-bar-list",children:d.serviceData.slice(0,8).map((a,s)=>{const n=d.serviceData[0]?.value||1,i=a.value/n*100;return e.jsxs("div",{className:"inline-bar-item",children:[e.jsx("span",{className:"inline-bar-label",title:a.fullName,children:F(a.name,22)}),e.jsx("div",{className:"inline-bar-track",children:e.jsx("div",{className:"inline-bar-fill",style:{width:`${i}%`,background:O[(s+2)%O.length]}})}),e.jsx("span",{className:"inline-bar-value",children:m(a.value,!0)})]},a.name)})})]})]})]})}export{Qe as default};
