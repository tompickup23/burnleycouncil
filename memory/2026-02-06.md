# 2026-02-06 - News Lancashire Major Overhaul

## What Changed (by Dominus/Claude Code)

Tom's Claude Code session audited everything Octavian built and did a comprehensive overhaul. Here's the current state:

### Thurinus (Oracle VPS - 141.147.79.228) - PRIMARY SERVER

**Hugo Theme v2 - LIVE:**
- Apple-quality dark glass design (matches burnleycouncil.co.uk aesthetic)
- Dark-only: #0a0a0a background, rgba glass cards, backdrop-filter blur
- 14 Lancashire borough dropdown navigation with grid layout
- Newsletter signup form in footer
- Schema.org JSON-LD (NewsArticle, Organization, BreadcrumbList)
- Critical CSS inline, main CSS preloaded, JS deferred
- Lazy image loading, staggered animations
- Theme at: `~/newslancashire/site/themes/newslancashire-theme-v2/`

**Database Updated:**
- All 14 borough columns now in SQLite: burnley, blackpool, preston, lancaster, pendle, rossendale, hyndburn, ribble_valley, blackburn, chorley, south_ribble, west_lancashire, wyre, fylde
- 239 articles, borough-tagged with keyword detection
- 182 unique Hugo content files generated

**Crawler v2:**
- Detects all 14 boroughs (was only 4)
- Auto-exports Burnley JSON to `/export/burnley-news.json`
- SCP sync to Octavianus (if SSH key exists)
- Rate-limited, WAL mode, 30-day cleanup
- At: `~/newslancashire/scripts/crawler.py`

**Content Generator:**
- Reads SQLite DB, creates Hugo .md files in correct borough directories
- Auto-detects primary borough, builds tags, cleans HTML
- At: `~/newslancashire/scripts/generate_hugo_content.py`

**Pipeline (hourly cron):**
- `~/newslancashire/scripts/pipeline.sh`
- Runs: crawler -> content generator -> Hugo rebuild
- Cron: `0 * * * *`

**Content Structure (all 14 boroughs + sections):**
- `/burnley/` - 19 articles
- `/blackpool/` - 28 articles
- `/preston/` - 26 articles
- `/lancaster/` - 21 articles
- `/blackburn/` - 8 articles
- `/pendle/` - 4 articles
- `/ribble-valley/` - 6 articles
- `/fylde/` - 4 articles
- `/wyre/` - 4 articles
- `/chorley/` - 2 articles
- `/south-ribble/` - 3 articles
- `/hyndburn/` - 2 articles
- `/rossendale/` - 1 article
- `/posts/` - 54 general Lancashire articles
- `/original/` - Tom's reporting
- `/digest/` - AI summaries
- `/guest/` - Guest posts

**Hugo Config:**
- All 14 borough permalink sections defined
- SEO keywords include "Tom Pickup", "Reform UK Lancashire"
- Language: en-gb, timezone: Europe/London

### Octavianus (AWS t3.micro - 51.20.51.127) - BURNLEY WORKER

**Security Hardened:**
- SSL certificate installed (Let's Encrypt, newsburnley.co.uk)
- UFW active (22/tcp, 80/tcp, 443/tcp only)
- Fail2ban running
- Nginx: HTTP/2, HSTS, security headers, gzip, caching
- CORS headers for JSON endpoint

**Current Role:**
- Serves newsburnley.co.uk (static HTML + Burnley JSON from Thurinus)
- Receives SCP sync of burnley-news.json from Thurinus

**Cost Warning:**
- AWS t3.micro is NOT free after 12-month trial (~$8.50/month)
- Recommendation: Migrate newsburnley.co.uk to Thurinus (Oracle free tier) via Nginx virtual host
- This would eliminate Octavianus entirely and save money

### Dominus (Mac/Clawdbot) - ORCHESTRATOR

**Role:**
- Generate AI digest content for `/digest/` section
- SSH to Thurinus for content management
- Run easy-update.sh for manual content

**SSH Access:**
- Thurinus: `ssh -i /Users/tompickup/Downloads/ssh-key-2026-02-05.key ubuntu@141.147.79.228`
- Octavianus: `ssh -i /Users/tompickup/Downloads/clawdbotkeypair.pem ubuntu@51.20.51.127`

## Architecture Summary

```
[RSS Feeds] --> [Thurinus Crawler] --> [SQLite DB]
                                         |
                                    [Content Gen] --> [Hugo .md files]
                                         |
                                    [Hugo Build] --> [Static HTML]
                                         |
                                    [Nginx] --> newslancashire.co.uk
                                         |
                                    [SCP Export] --> [Octavianus]
                                                         |
                                                    [Nginx] --> newsburnley.co.uk
```

## Slack Integration (added by Claude Code)

Slack channel added to the main Octavian gateway. No separate GaiusOctavianus process needed.
- Bot Token: xoxb-1045...prXd5
- App Token: xapp-1-A0AD8JK850D-...e33500bd
- Socket Mode: enabled and connected
- Workspace: GaiusOctavianus (gaiusoctavianus.slack.com)

All four channels now active on ONE gateway:
- WhatsApp (+447308907628)
- Slack (Socket Mode)
- Telegram (@octavian_gaius_julius_caesar_bot)
- Discord (Octavian bot)

## Heartbeat Changed
- Switched from Haiku (costs Anthropic credits) to Kimi K2.5 (free)
- Still runs hourly

## Architecture Document
- Full system architecture written to ~/clawd/ARCHITECTURE.md
- Covers all agents, servers, projects, credit efficiency rules, workflows

## What Octavian Should Do Next

1. **Generate AI digests** - Read articles from DB, write summaries for `/digest/` section
2. **Don't touch the theme** - v2 is deployed and working, don't overwrite
3. **Don't modify crawler v2** - it works, runs hourly via pipeline.sh
4. **If writing content** - create .md files in correct content directories with proper front matter:
   ```yaml
   ---
   title: "Article Title"
   date: 2026-02-06T12:00:00+00:00
   source: "AI Summary"
   location: "burnley"
   type: "ai"
   tags:
     - "Burnley"
     - "Lancashire"
   draft: false
   ---
   ```
5. **After adding content** - rebuild Hugo: `cd ~/newslancashire/site && hugo --gc --minify`
